"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],i=!0,o=!1,s=void 0;try{for(var r,a=t[Symbol.iterator]();!(i=(r=a.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){o=!0,s=t}finally{try{i||null==a.return||a.return()}finally{if(o)throw s}}return n}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var poErrorLogger=function(){function t(t){t=t||{};var e={url:location.href,headers:{"User-Agent":navigator.userAgent}};return{event_id:function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}(),platform:"javascript",extra:t,request:e}}function e(t){return Math.random()>.2?Promise.resolve():fetch(s,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}function n(t){var e=t.stack||"";if(e){var n=e.split("\n").map(function(t){return t.trim()}),i=n.filter(function(t){return t.startsWith("at")}),o=i.map(function(t){var e="",n=0,i=0,o="",s=t.split(/[ ]+/);if("at"===s[0].trim()&&s.length>1){var r="";s.length>2?(e=s[1],r=s[2]):r=s[1],r=r.replace("(","").replace(")","");var a=r.split(":");a.length>1&&(n=a[a.length-1],i=a[a.length-2],o=a.slice(0,a.length-2).join(":"))}return{in_app:!0,function:e,colno:Number(n)||n,lineno:Number(i)||i,filename:o}});return o.reverse(),{values:[{type:t.name||"Error",value:t.message||String(t),stacktrace:{frames:o}}]}}}function i(n,i){var o=t(i);return o.message=n,e(o)}function o(o,s){if(o)try{s=s||{},s.errorDump={str:String(o),stack:o&&o.stack};var r=t(s);return r.exception=n(o),e(r)}catch(t){i(String(t),t),i(String(o),o)}}var s="https://o344076.ingest.sentry.io/api/5289600/store/?sentry_version=7&sentry_key=54b34351f0944d469fbcf89767fa6f75";return{log:i,logException:o}}();window.addEventListener("error",function(t){if(!(t.message.indexOf("Script error.")>-1)){var e=t.filename;try{e.indexOf("pushowl")>-1&&e.indexOf("utm_source=pushowl")<0&&poErrorLogger.logException(t.error||t.message)}catch(t){}}});var PO_HS_CONSTANTS={SCREENS:{GRANT_PERMISSION:"grantPermission",DENIED_PERMISSION:"deniedPermission"},BROWSERS:{CHROME:"chrome",FIREFOX:"firefox"},DEVICE_TYPES:{DESKTOP:"desktop",ANDROID:"android"},ARROW_CONFIG:{START_REFERENCE:"start_reference"},CLASSES:{HS_CONTAINER:"po-hint-screen-widget-container",HS_SCREEN:"po-hint-screen",HS_CONTENT:"po-hs-content",HS_OVERLAY:"po-hs-overlay"}},defaultOptions={dismissOnOverlay:!0},PushowlHintScreen=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),this.container=document.querySelector("body"),this.widget=null,this.purge(),this.options=_objectSpread({},defaultOptions,{},e)}return _createClass(t,[{key:"render",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:PO_HS_CONSTANTS.SCREENS.GRANT_PERMISSION,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{if(this.purge(),this._getDeviceType()===PO_HS_CONSTANTS.DEVICE_TYPES.ANDROID&&e===PO_HS_CONSTANTS.SCREENS.GRANT_PERMISSION)return;var i=this._screenData(e);if(n){var o=n.title,s=n.subtitle,r=n.hintMediaUrl,a=n.branding;i.title=o||i.title,i.subtitle=s||i.subtitle,i.hintMediaUrl=r||i.hintMediaUrl,i.branding=!(!1===a)}var c=this._deviceScreenNodeFactory();this.widget=c(i),this.container.appendChild(this.widget),this.content=this.widget.querySelector(".".concat(PO_HS_CONSTANTS.CLASSES.HS_CONTENT)),this.hintScreen=this.widget.querySelector(".".concat(PO_HS_CONSTANTS.CLASSES.HS_SCREEN)),this.options.dismissOnOverlay&&this.hintScreen.addEventListener("click",function(){t.purge(),"function"==typeof t.options.onDismiss&&t.options.onDismiss()}),setTimeout(function(){t._getDeviceType(),PO_HS_CONSTANTS.DEVICE_TYPES.DESKTOP},10)}catch(t){}}},{key:"purge",value:function(){var t=this.container.querySelector(".".concat(PO_HS_CONSTANTS.CLASSES.HS_CONTAINER));t&&this.container.removeChild(t)}},{key:"_deviceArrowConfig",value:function(t){var e,n,i,o,s,r,a,c=this._getBrowser();return(a={},_defineProperty(a,PO_HS_CONSTANTS.SCREENS.GRANT_PERMISSION,(i={},_defineProperty(i,PO_HS_CONSTANTS.BROWSERS.CHROME,(e={},_defineProperty(e,PO_HS_CONSTANTS.ARROW_CONFIG.START_REFERENCE,{x:375,y:100}),_defineProperty(e,"padding",20),e)),_defineProperty(i,PO_HS_CONSTANTS.BROWSERS.FIREFOX,(n={},_defineProperty(n,PO_HS_CONSTANTS.ARROW_CONFIG.START_REFERENCE,{x:311,y:148}),_defineProperty(n,"padding",20),n)),i)),_defineProperty(a,PO_HS_CONSTANTS.SCREENS.DENIED_PERMISSION,(r={},_defineProperty(r,PO_HS_CONSTANTS.BROWSERS.CHROME,(o={},_defineProperty(o,PO_HS_CONSTANTS.ARROW_CONFIG.START_REFERENCE,{x:131,y:0}),_defineProperty(o,"padding",0),o)),_defineProperty(r,PO_HS_CONSTANTS.BROWSERS.FIREFOX,(s={},_defineProperty(s,PO_HS_CONSTANTS.ARROW_CONFIG.START_REFERENCE,{x:60,y:0}),_defineProperty(s,"padding",0),s)),r)),a)[t][c]}},{key:"_get_arrow_node",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:PO_HS_CONSTANTS.SCREENS.GRANT_PERMISSION,n=this._deviceArrowConfig(e),i=n[PO_HS_CONSTANTS.ARROW_CONFIG.START_REFERENCE],o={x:(window.innerWidth-this.content.getBoundingClientRect().width)/2,y:(window.innerHeight-this.content.getBoundingClientRect().height)/2},s=Math.sqrt(Math.pow(i.x-o.x,2)+Math.pow(i.y-o.y,2)),r=Math.max(.1*s,15),a=i.x,c=i.y+1*r+n.padding,u=o.x-20,l=Math.max(o.y+40,c+40),p=u-a,d=l-c,h="M ".concat(u," ").concat(l," q ").concat(-1*p," ").concat(d,", -").concat(p," ").concat(-1*d),f="M ".concat(a-r," ").concat(c+r," q ").concat(r," -").concat(3*r,", ").concat(2*r," 0"),g='<div class="po-helper-arrow-container">\n    <style>\n        .po-helper-arrow {\n            position: fixed;\n            top: 0;\n            left: 0;\n        }\n    </style>\n    <div class="po-helper-arrow">\n        <svg width="'.concat(window.innerWidth,'px" height="').concat(window.innerHeight,'px" viewBox="0 0 ').concat(window.innerWidth," ").concat(window.innerHeight,'" version="1.1"\n             xmlns="http://www.w3.org/2000/svg">\n            <desc>Arrow</desc>\n            <defs></defs>\n            <g id="Interaction-Flow" stroke-width="5" stroke-linecap="round" fill="none" fill-rule="evenodd">\n                <path d="').concat(h,'" id="tail" stroke="#FFFFFF"></path>\n                <path d="').concat(f,'" id="head" stroke="#FFFFFF"></path>\n            </g>\n        </svg>\n    </div>\n</div>');return t._parseHTML(g)}},{key:"_deviceScreenNodeFactory",value:function(){return this._getDeviceType()===PO_HS_CONSTANTS.DEVICE_TYPES.DESKTOP?this._desktopScreenNode:this._mobileScreenNode}},{key:"_desktopScreenNode",value:function(e){var n=e.title,i=e.subtitle,o=e.hintMediaUrl,s=e.branding,r='<div class="'.concat(PO_HS_CONSTANTS.CLASSES.HS_CONTAINER,'">\n    <style>\n        .po-hint-screen-widget * {\n            font-family: "Roboto", sans-serif;\n            line-height: 1em;\n        }\n\n        .').concat(PO_HS_CONSTANTS.CLASSES.HS_CONTENT," {\n            width: 462px;\n        }\n\n        .").concat(PO_HS_CONSTANTS.CLASSES.HS_OVERLAY," {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100vw;\n            height: 100vh;\n            background-color: rgba(0, 0, 0, .8);\n            z-index: 2147483646;\n        }\n\n        .").concat(PO_HS_CONSTANTS.CLASSES.HS_SCREEN," {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100vw;\n            height: 100vh;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            z-index: 2147483647;\n        }\n\n        @media (max-height: 700px) {\n            .po-hs-content {\n                transform: scale(0.7);\n            }\n        }\n\n        .").concat(PO_HS_CONSTANTS.CLASSES.HS_CONTENT," .title {\n            font-size: 47px;\n            color: white;\n        }\n\n        .").concat(PO_HS_CONSTANTS.CLASSES.HS_CONTENT," .sub-title {\n            font-size: 17px;\n            color: white;\n            margin-top: 35px;\n        }\n\n        .").concat(PO_HS_CONSTANTS.CLASSES.HS_CONTENT," .hint-media {\n            margin-top: 35px;\n        }\n\n        .").concat(PO_HS_CONSTANTS.CLASSES.HS_CONTENT,' .hint-media img {\n            width: 100%;\n        }\n\n        .po-branding {\n            position: fixed;\n            bottom: 20px;\n            width: 100%;\n            display: flex;\n            justify-content: center;\n            z-index: 2147483647;\n        }\n\n    </style>\n    <div class="po-hint-screen-widget">\n        <div class="').concat(PO_HS_CONSTANTS.CLASSES.HS_OVERLAY,'">\n            <div class="').concat(PO_HS_CONSTANTS.CLASSES.HS_SCREEN,'">\n                <div class="').concat(PO_HS_CONSTANTS.CLASSES.HS_CONTENT,'">\n                    <div class="hint-content">\n                        <div class="title">').concat(n,'</div>\n                        <div class="sub-title">').concat(i,'</div>\n                        <div class="hint-media">\n                            <img src="').concat(o,'">\n                        </div>\n                    </div>\n                </div>');return!1!==s&&(r+='\n                <div class="po-branding">\n                    <a href="https://pushowl.com?ref=hint-screen-branding" target="_blank">\n                        <svg width="113px" height="49px" viewBox="0 0 226 98" version="1.1"\n                             xmlns="http://www.w3.org/2000/svg">\n                            \x3c!-- Generator: Sketch 43.2 (39069) - http://www.bohemiancoding.com/sketch --\x3e\n                            <desc>Created with Sketch.</desc>\n                            <defs></defs>\n                            <g id="Interaction-Flow" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                                <g id="Chrome-Hint-Screen" transform="translate(-1439.000000, -1519.000000)"\n                                   fill="#FFFFFF">\n                                    <g id="First-Trial">\n                                        <g id="powered-by-pushowl" transform="translate(1425.000000, 1515.000000)">\n                                            <text id="Powered-By" font-family="Roboto-Regular, Roboto, sans-serif" font-size="18"\n                                                  font-weight="normal">\n                                                <tspan x="21.8203125" y="17">Powered By</tspan>\n                                            </text>\n                                            <g id="logo" transform="translate(14.000000, 43.000000)">\n                                                <path d="M221.702096,32.4774095 L221.702096,9.62170055 L226,9.62170055 L226,32.4774095 L221.702096,32.4774095 Z M210.2983,32.4774095 L207.345961,20.8966108 L204.414244,32.4774095 L199.793266,32.4774095 L194.555356,15.2961029 L198.930592,15.2961029 L202.071963,28.3530711 L205.215053,15.2961029 L209.775884,15.2961029 L212.857108,28.3221385 L215.998479,15.2961029 L220.158906,15.2961029 L214.920996,32.4774095 L210.2983,32.4774095 L210.2983,32.4774095 Z M192.166677,30.1969941 C190.46195,31.8329817 188.349372,32.6504026 185.828943,32.649257 C183.308514,32.6481113 181.21083,31.8306904 179.53589,30.1969941 C177.862096,28.5627249 177.025199,26.4203602 177.025199,23.7699 C177.025199,21.121731 177.872407,18.9896771 179.566823,17.3737384 C181.261239,15.760091 183.364078,14.9529808 185.875342,14.952408 C188.386606,14.9518352 190.488873,15.7589453 192.182143,17.3737384 C193.876559,18.9891043 194.723767,21.1211581 194.723767,23.7699 C194.723767,26.4186418 193.871403,28.5610065 192.166677,30.1969941 L192.166677,30.1969941 Z M188.989218,19.9823825 C188.175216,19.1150711 187.033758,18.6304194 185.84441,18.6471279 C184.66275,18.6263577 183.528713,19.1123737 182.728816,19.9823825 C181.881608,20.8725522 181.457717,22.1453689 181.457145,23.8008325 C181.456572,25.4562961 181.880462,26.7291128 182.728816,27.6192825 C183.52332,28.4877472 184.652043,28.973899 185.828943,28.9545371 C187.02043,28.9661437 188.16182,28.4759075 188.973751,27.6038163 C189.851892,26.7050542 190.291248,25.4322375 190.291821,23.7853662 C190.291821,22.1407863 189.85762,20.873125 188.989218,19.9823825 L188.989218,19.9823825 Z M171.00882,23.027519 C171.00882,21.6888275 170.63763,20.6628983 169.958833,19.9531684 C169.280035,19.2434385 168.350341,18.8877143 167.174904,18.8877143 C165.999468,18.8877143 165.066336,19.2434385 164.377228,19.9531684 C163.68812,20.6628983 163.275686,21.6888275 163.275686,23.027519 L163.275686,32.479128 L158.981218,32.4774095 L158.981218,9.62170055 L163.275686,9.62341903 L163.275686,17.872096 C164.368636,15.9989589 166.205685,15.1191 168.659666,15.1191 C170.617008,15.1191 172.214617,15.7623823 173.452491,17.0489467 C174.690365,18.3355112 175.308443,20.1221517 175.306725,22.4088683 L175.306725,32.4774095 L171.00882,32.479128 L171.00882,23.027519 L171.00882,23.027519 Z M150.380254,22.3727803 C151.347755,22.560094 152.311247,22.7932337 153.270728,23.0721994 C154.208911,23.3388952 155.05784,23.8535951 155.728146,24.5621166 C156.408662,25.2752835 156.748347,26.2221629 156.747202,27.4027548 C156.747202,28.9545371 156.093036,30.2170429 154.784704,31.1902722 C153.476372,32.1635016 151.807161,32.6498298 149.77707,32.649257 C147.747552,32.649257 146.083496,32.1680842 144.784902,31.2057385 C143.485735,30.2433929 142.777724,28.7809712 142.653994,26.9800101 L147.122027,26.9800101 C147.254349,28.4235285 148.185763,29.2346484 149.854401,29.2346484 C150.658647,29.2346484 151.307658,29.0536358 151.801433,28.6916105 C152.27426,28.3715821 152.553504,27.8344263 152.543813,27.2635583 C152.543813,26.6724032 152.203556,26.2066966 151.52304,25.8664387 C150.739051,25.4900229 149.906928,25.2234431 149.050155,25.074222 C148.080936,24.8886268 147.117444,24.6612153 146.159681,24.3919877 C145.226773,24.1369254 144.378587,23.6380973 143.702263,22.9467507 C143.021747,22.2542056 142.682062,21.3485696 142.683208,20.2298428 C142.683208,18.7399255 143.311596,17.4877305 144.568374,16.4732578 C145.825152,15.4587851 147.494363,14.9518352 149.576008,14.952408 C151.657081,14.952408 153.326292,15.4542025 154.583643,16.4577916 C155.841566,17.4630991 156.491149,18.9031806 156.573636,20.6216549 L152.105603,20.6216549 C152.012805,19.1609517 151.131228,18.368735 149.483211,18.368735 C148.658343,18.368735 148.019643,18.5342814 147.567112,18.8653741 C147.123526,19.1753335 146.867322,19.6890363 146.886596,20.2298428 C146.886596,20.8106871 147.226854,21.2660828 147.90737,21.5960299 C148.694019,21.9623104 149.525453,22.2234696 150.380254,22.3727803 L150.380254,22.3727803 Z M136.233773,29.8361144 C135.140824,31.7126884 133.35762,32.6509754 130.884163,32.6509754 C128.945724,32.6509754 127.358426,32.0065476 126.12227,30.7176918 C124.886114,29.428836 124.267464,27.6399042 124.266318,25.3508964 L124.266318,15.2961029 L128.562504,15.2943844 L128.562504,24.7459934 C128.562504,26.0864034 128.935413,27.1037402 129.615929,27.8254994 C130.296444,28.5472587 131.224421,28.9081383 132.399857,28.9081383 C133.575294,28.9081383 134.506707,28.5472587 135.197533,27.8254994 C135.88836,27.1037402 136.295638,26.0864034 136.295638,24.7459934 L136.295638,15.2943844 L140.593543,15.2961029 L140.593543,32.4344477 L136.233773,32.4344477 L136.233773,29.8361144 Z M114.465859,32.6200429 C112.139044,32.6200429 110.425725,31.6456679 109.143744,29.5577216 L109.143744,40.5559575 L104.677429,40.5559575 L104.67571,15.122537 L109.143744,15.122537 L109.143744,17.872096 C110.36386,15.9302199 112.061713,14.952408 114.41946,14.952408 C116.777207,14.952408 118.720801,15.7738388 120.251962,17.4167002 C121.783122,19.0595617 122.546125,21.1784406 122.546125,23.7716184 C122.546125,26.3647962 121.781404,28.4871121 120.251962,30.1402844 C118.72252,31.7934567 116.792673,32.6200429 114.465859,32.6200429 L114.465859,32.6200429 Z M116.76174,20.0665877 C115.923312,19.2120518 114.775603,18.7318871 113.578446,18.7347983 C112.381289,18.7377095 111.235929,19.2234505 110.401667,20.082054 C109.501186,20.9808161 109.143744,22.1442232 109.143744,23.7149088 C109.143744,25.2855943 109.501186,26.5916349 110.401667,27.4903969 C111.234627,28.3550482 112.384405,28.8422734 113.585003,28.8393538 C114.785601,28.8364342 115.932996,28.3436228 116.76174,27.4749307 C117.660502,26.5658577 118.11017,25.3262649 118.110743,23.7561522 C118.111316,22.1860394 117.661648,20.9561846 116.76174,20.0665877 Z M85.7398412,14.0192764 C85.7432782,14.0295873 85.7484336,14.0416166 85.753589,14.0536459 C86.8671084,16.7632359 87.4381185,19.6649945 87.4342569,22.5944635 C87.4342569,35.0705873 77.2952582,45.1872459 64.7950757,45.1872459 C52.2880193,45.1872459 42.1558945,35.0705873 42.1558945,22.5944635 C42.1558945,10.1183396 52.2880193,-3.738714e-05 64.7933573,-3.738714e-05 L87.4720634,-3.738714e-05 C85.64583,2.47691279 84.6644026,5.47541737 84.6726687,8.5528095 C84.6716166,10.4268243 85.0340322,12.2832562 85.7398412,14.0192764 L85.7398412,14.0192764 Z M64.7950757,5.69326817 C55.4650749,5.7112926 47.9145349,13.2861783 47.9265454,22.6161888 C47.9385559,31.9461993 55.5085731,39.5016203 64.8385894,39.4956238 C74.1686057,39.4896273 81.7289047,31.9244818 81.7289221,22.5944635 C81.7186771,13.2516851 74.1378565,5.68548148 64.7950757,5.69326817 L64.7950757,5.69326817 Z M64.7933573,22.4982289 C63.439998,22.4973744 62.342138,23.5936958 62.3410943,24.9470549 L58.7563568,24.9470549 C58.7563568,21.6129116 61.459214,18.9100545 64.7933573,18.9100545 C68.1275005,18.9100545 70.8303577,21.6129116 70.8303577,24.9470549 L67.2456202,24.9470549 C67.2445765,23.5936958 66.1467165,22.4973744 64.7933573,22.4982289 L64.7933573,22.4982289 Z M22.6787061,22.4982289 C22.0286976,22.4974993 21.4050519,22.7551557 20.945104,23.214459 C20.4851561,23.6737623 20.2266252,24.297046 20.2264432,24.9470549 L16.6417057,24.9470549 C16.6417057,21.6129116 19.3445629,18.9100545 22.6787061,18.9100545 C26.0128494,18.9100545 28.7157066,21.6129116 28.7157066,24.9470549 L25.130969,24.9470549 C25.1299254,23.5936958 24.0320653,22.4973744 22.6787061,22.4982289 L22.6787061,22.4982289 Z M41.6197305,34.9777897 C41.6192226,34.9798571 41.6180065,34.9816812 41.6162936,34.9829452 C44.4706538,40.2891818 49.0570801,44.4571164 54.6113967,46.792301 C51.7913803,50.980223 48.0863495,54.7969545 43.6922106,58.1067361 C38.2257437,53.9927085 33.8316047,49.0916196 30.8534887,43.669833 C30.8809842,43.6578037 30.9084798,43.6440559 30.9359754,43.6337451 C28.3052464,44.662446 25.5051293,45.1893623 22.6804246,45.1872459 C10.1733682,45.1872459 0.0360879616,35.0705873 0.0360879616,22.5944635 C0.0326187484,19.6165944 0.621448486,16.6677725 1.76831012,13.9196049 C2.4489713,12.2121703 2.79887623,10.3909151 2.79939473,8.5528095 C2.80766077,5.47541737 1.82623341,2.47691279 -9.09494702e-13,-3.73871396e-05 L22.6804246,-3.73871396e-05 C30.31072,-0.00634323931 37.4307646,3.83180071 41.6197305,10.2094188 C40.3290276,12.6025187 39.4226339,15.183682 38.9337551,17.8583482 C36.5774017,9.78438516 28.6430238,4.67146917 20.3168711,5.86162142 C11.9907185,7.05177367 5.80651029,14.1828207 5.80651029,22.5936043 C5.80651029,31.0043878 11.9907185,38.1354348 20.3168711,39.3255871 C28.6430238,40.5157393 36.5774017,35.4028234 38.9337551,27.3288604 C39.4223574,30.0035998 40.3287659,32.5848054 41.6197305,34.9777897 L41.6197305,34.9777897 Z"></path>\n                                            </g>\n                                        </g>\n                                    </g>\n                                </g>\n                            </g>\n                        </svg>\n                    </a>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'),r+="  </div>\n                      </div>\n                    </div>\n                </div>\n                ",t._parseHTML(r)}},{key:"_mobileScreenNode",value:function(e){var n=e.title,i=e.subtitle,o=(e.hintMediaUrl,e.showInstructions),s=o?0:130,r=window.outerHeight-s,a='<div class="'.concat(PO_HS_CONSTANTS.CLASSES.HS_CONTAINER,'">\n    <style>\n        .po-hint-screen-widget * {\n            font-family: "Roboto";\n            line-height: 1em;\n        }\n        \n        .').concat(PO_HS_CONSTANTS.CLASSES.HS_CONTENT," {\n            width: 325px;\n        }\n        \n        .").concat(PO_HS_CONSTANTS.CLASSES.HS_OVERLAY," {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100vw;\n            height: 100vh;\n            background-color: rgba(0, 0, 0, .8);\n            z-index: 2147483646;\n        }\n\n        .").concat(PO_HS_CONSTANTS.CLASSES.HS_SCREEN," {\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            z-index: 2147483647;\n            flex-grow: 1;\n            height: ").concat(r,"px;\n        }\n        \n        .").concat(PO_HS_CONSTANTS.CLASSES.HS_CONTENT," .title {\n            font-size: 30px;\n            color: white;\n            margin-top: 50px;\n        }\n        \n        .").concat(PO_HS_CONSTANTS.CLASSES.HS_CONTENT," .sub-title {\n            font-size: 14px;\n            line-height: 16px;\n            color: white;\n            margin-top: 35px;\n        }\n        \n        .po-branding {\n            z-index: 2147483647;\n        }\n        \n        .instructions {\n            display: ").concat(o?"block":"none",";\n        }\n        \n        .filler-container .padding-box {\n            display: ").concat(o?"none":"block",';\n        }\n        \n        .instructions ul {\n            list-style-type: none;\n            padding-left: 0;\n        }\n        \n        .instructions ul li {\n            color: white;\n            font-size: 14px;\n            line-height: 16px;\n        }\n        \n        .filler-container {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100vw;\n            height: 100vh;\n            z-index: 2147483647;\n        }\n       \n    </style>\n    <div class="po-hint-screen-widget">\n        <div class="').concat(PO_HS_CONSTANTS.CLASSES.HS_OVERLAY,'"></div>\n        <div class="filler-container">\n            <div class="').concat(PO_HS_CONSTANTS.CLASSES.HS_SCREEN,'">\n                <div class="').concat(PO_HS_CONSTANTS.CLASSES.HS_CONTENT,'">\n                    <div class="hint-content">\n                        <div class="po-branding">\n                            <a href="https://pushowl.com?ref=hint-screen-branding" target="_blank">\n                                <svg width="30px" height="20px" viewBox="0 0 30 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                                    \x3c!-- Generator: Sketch 43.2 (39069) - http://www.bohemiancoding.com/sketch --\x3e\n                                    <desc>Created with Sketch.</desc>\n                                    <defs></defs>\n                                    <g id="Interaction-Flow" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                                        <g id="Mobile-Hint-Screen" transform="translate(-82.000000, -291.000000)" fill="#FFFFFF">\n                                            <g id="First-Trial">\n                                                <g id="Hint-Content" transform="translate(81.000000, 291.000000)">\n                                                    <g id="Text">\n                                                        <g id="logo" transform="translate(1.000000, 0.000000)">\n                                                            <path d="M14.2821254,12.0080321 C14.2821254,12.0073293 14.2829453,12.0068608 14.2832967,12.006158 C13.8458096,11.1959886 13.5386473,10.3219733 13.3730987,9.41623428 C12.5751013,12.1502087 9.88833033,13.8814707 7.06893987,13.4784155 C4.24954941,13.0753602 2.1554813,10.6606376 2.1554813,7.81258281 C2.1554813,4.96452802 4.24954941,2.54980541 7.06893987,2.14675016 C9.88833033,1.74369491 12.5751013,3.4749569 13.3730987,6.20893135 C13.53867,5.30319839 13.8458311,4.4291865 14.2832967,3.61900759 C12.8636627,1.45901918 10.4516789,0.159222273 7.86693392,0.161286018 L0.183368495,0.161286018 C0.802163714,0.999937378 1.13478891,2.01538872 1.13210142,3.05761538 C1.13207716,3.68009859 1.01345964,4.29687786 0.782592896,4.874966 C-0.387572866,7.7141752 0.249165924,10.9776912 2.40078661,13.1687926 C4.55240729,15.359894 7.80380737,16.0558613 10.663822,14.9375085 C10.6543347,14.9412566 10.645433,14.9459417 10.6358285,14.9492213 C11.6446479,16.7858979 13.1332216,18.4448922 14.9850077,19.8387097 C16.4219742,18.7755879 17.6720437,17.4807897 18.6840119,16.0073513 C16.8026392,15.2167027 15.2490409,13.8051862 14.2821254,12.0080321 Z M5.8210675,8.60922565 L7.03532852,8.60922565 C7.04073112,8.15421076 7.41112563,7.78818801 7.86617259,7.78818801 C8.32121956,7.78818801 8.69161407,8.15421076 8.69701667,8.60922565 L9.91151194,8.60922565 C9.91151194,7.87853813 9.52169479,7.20335502 8.88890083,6.83801125 C8.25610688,6.47266749 7.47647257,6.47266749 6.84367861,6.83801125 C6.21088465,7.20335502 5.8210675,7.87853813 5.8210675,8.60922565 L5.8210675,8.60922565 Z M29.2340392,4.92064574 L29.2293541,4.90893299 C28.5883313,3.33165191 28.8105959,1.53482823 29.8166315,0.161286018 L22.1337688,0.161286018 C17.9103398,0.171307042 14.4937625,3.60143642 14.5004607,7.82487202 C14.507159,12.0483076 17.9345994,15.4675825 22.1580389,15.464207 C26.3814785,15.4608315 29.8034489,12.0360823 29.8033961,7.81264138 C29.8048318,6.82069694 29.6113832,5.83813266 29.2340392,4.92076287 L29.2340392,4.92076287 L29.2340392,4.92064574 Z M22.1342374,13.5360777 C18.974924,13.528772 16.4190369,10.963 16.4239261,7.803682 C16.4288154,4.64436401 18.9926316,2.0865151 22.1519525,2.08898783 C25.3112733,2.09146055 27.8710824,4.65331961 27.8710262,7.81264138 C27.8668241,10.9770812 25.2986783,13.5392495 22.1342374,13.5360777 L22.1342374,13.5360777 Z M22.1342374,6.5687471 C21.5924271,6.56809437 21.0725505,6.78270986 20.6889825,7.16537727 C20.3054145,7.54804467 20.0895775,8.06741538 20.0889566,8.60922565 L21.3033347,8.60922565 C21.3033347,8.15033082 21.6753425,7.77832306 22.1342374,7.77832306 C22.5931322,7.77832306 22.96514,8.15033082 22.96514,8.60922565 L24.179401,8.60922565 C24.1788112,8.06732454 23.9629199,7.54786466 23.5792438,7.16517706 C23.1955676,6.78248945 22.6755526,6.5679389 22.1336517,6.5687471 L22.1342374,6.5687471 Z" id="Shape"></path>\n                                                        </g>\n                                                    </g>\n                                                </g>\n                                            </g>\n                                        </g>\n                                    </g>\n                                </svg>\n                            </a>\n                        </div>\n                        <div class="title">').concat(n,'</div>\n                        <div class="sub-title">').concat(i,'</div>\n                        <div class="instructions">\n                            <ul>\n                                <li>1. \tClick on the lock icon \n                                    <span>\n                                      <svg width="12px" height="17px" viewBox="0 0 12 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                                        <path d="M10.5 6h-.75V4.5C9.75 2.43 8.07.75 6 .75 3.93.75 2.25 2.43 2.25 4.5V6H1.5C.675 6 0 6.675 0 7.5V15c0 .825.675 1.5 1.5 1.5h9c.825 0 1.5-.675 1.5-1.5V7.5c0-.825-.675-1.5-1.5-1.5zM6 12.75c-.825 0-1.5-.675-1.5-1.5s.675-1.5 1.5-1.5 1.5.675 1.5 1.5-.675 1.5-1.5 1.5zM8.325 6h-4.65V4.5A2.327 2.327 0 016 2.175 2.327 2.327 0 018.325 4.5V6z" fill-rule="nonzero" fill="#FFF"/>\n                                      </svg>\n                                    </span> in the address bar above.</li>\n                                <li>2. \tClick on ‘Permission Settings’.</li>\n                                <li>3. \tChange Notifications permission to ‘Allow’.</li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="padding-box" style="height: ').concat(s,'px; width: 100%;"></div>\n        </div>\n\n    </div>\n</div>\n');return t._parseHTML(a)}},{key:"_getDeviceType",value:function(){return/(android)/i.test(navigator.userAgent)?PO_HS_CONSTANTS.DEVICE_TYPES.ANDROID:PO_HS_CONSTANTS.DEVICE_TYPES.DESKTOP}},{key:"_getBrowser",value:function(){var t="undefined"!=typeof InstallTrigger;return!window.chrome?t?PO_HS_CONSTANTS.BROWSERS.FIREFOX:null:PO_HS_CONSTANTS.BROWSERS.CHROME}},{key:"_screenData",value:function(){var t,e,n,i,o,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:PO_HS_CONSTANTS.SCREENS.GRANT_PERMISSION,r=(o={},_defineProperty(o,PO_HS_CONSTANTS.DEVICE_TYPES.DESKTOP,(n={},_defineProperty(n,PO_HS_CONSTANTS.BROWSERS.CHROME,(t={},_defineProperty(t,PO_HS_CONSTANTS.SCREENS.GRANT_PERMISSION,{title:"One more step to go!",subtitle:"Click ‘Allow’ to receive updates from us. Rest assured - we hate spam as much as you do.",
hintMediaUrl:"https://static.pushowl.com/sdks/hint-screen/ChromeSubscriptionGIF.gif"}),_defineProperty(t,PO_HS_CONSTANTS.SCREENS.DENIED_PERMISSION,{title:"Change your settings to allow notifications",subtitle:"Change notifications permission to ‘Allow’ to receive updates from us. No spam, pinky promise.",hintMediaUrl:"https://static.pushowl.com/sdks/hint-screen/ChromeDesktopUnblock.gif"}),t)),_defineProperty(n,PO_HS_CONSTANTS.BROWSERS.FIREFOX,(e={},_defineProperty(e,PO_HS_CONSTANTS.SCREENS.GRANT_PERMISSION,{title:"One more step to go!",subtitle:"Click ‘Allow’ to receive updates from us. Rest assured - we hate spam as much as you do.",hintMediaUrl:"https://static.pushowl.com/sdks/hint-screen/FirefoxSubscriptionGIF.gif"}),_defineProperty(e,PO_HS_CONSTANTS.SCREENS.DENIED_PERMISSION,{title:"Change your settings to allow notifications",subtitle:"Remove ‘Blocked’ from notification permissions to receive updates from us. No spam, pinky promise.",hintMediaUrl:"https://storage.googleapis.com/pushowl/sdk/general/hint-screen/FirefoxDesktopUnblock.gif"}),e)),n)),_defineProperty(o,PO_HS_CONSTANTS.DEVICE_TYPES.ANDROID,_defineProperty({},PO_HS_CONSTANTS.BROWSERS.CHROME,(i={},_defineProperty(i,PO_HS_CONSTANTS.SCREENS.GRANT_PERMISSION,{title:"One more step to go!",subtitle:"Click ‘Allow’ to receive updates from us. Rest assured - we hate spam as much as you do.",hintMediaUrl:"https://static.pushowl.com/sdks/hint-screen/ChromeSubscriptionGIF.gif"}),_defineProperty(i,PO_HS_CONSTANTS.SCREENS.DENIED_PERMISSION,{title:"Change your settings to allow notifications",subtitle:"Change notifications permission to ‘Allow’ to receive updates from us. No spam, pinky promise.",hintMediaUrl:"https://static.pushowl.com/sdks/hint-screen/ChromeDesktopUnblock.gif",showInstructions:!0}),i))),o),a=this._getDeviceType(),c=this._getBrowser();return r[a][c][s]}}],[{key:"_parseHTML",value:function(t){var e=document.implementation.createHTMLDocument();return e.body.innerHTML=t,e.body.children[0]}}]),t}();!function(){function t(){for(var t=console,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];S.push(n),(localStorage.getItem("pushowl_log_level")===_.DEBUG||location.href.match(/poTaskType=debug/))&&t.log.apply(t,["%c🦉PushOwl","background: #fb446a; color: white; padding: 2px 0.5em; border-radius: 0.5em;"].concat(n))}function e(e,n){var i=console;S.push([e,n]),(localStorage.getItem("pushowl_log_level")===_.DEBUG||location.href.match(/poTaskType=debug/))&&(e&&t(e),i.table(n))}function n(t){t!==h.NOTIFICATION_NOT_DEFINED&&poErrorLogger.logException(t,{breadcrumbs:S})}function i(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),!0}catch(t){return!1}}function o(t){var e,n="pushowl_ab_test_".concat(t,"_variation");return window.localStorage.getItem(n)?e=window.localStorage.getItem(n):(e=Math.floor(2*Math.random()),window.localStorage.setItem(n,e),window.poAnalytics.track("ABTestVariationDecided",{testId:t,variation:e})),parseInt(e,10)}function s(t,e){return e.flags&&"enabled"===e.flags["abtest_".concat(t)]&&b.browser.isChrome&&!b.isMobile()}function r(){var t=Object.keys(window.localStorage),e={};return t.filter(function(t){if(t.match(/pushowl_ab_test_.*_variation/))return t}).map(function(t){var n=window.localStorage.getItem(t);n=isNaN(n)?n:parseInt(n,10),e[t.replace("pushowl_","")]=n}),e}var a,c,u,l={CHROME:"chrome",FIREFOX:"firefox",SAFARI:"safari",OTHERS:"others"},p={ONE_STEP:"oneStep",TWO_STEP:"twoStep",OFF:"off"},d={CUSTOM_BUTTONS:"custom-buttons",FLYOUT_WIDGET:"flyout-widget",PARTNER_JS_API:"partner-js-api"},h={NOT_SHOPIFY:"not_shopify",STORAGE_NOT_DEFINED:"storage_not_defined",LOCALSTORAGE_NOT_AVAILABLE:"localstorage_not_available",IN_COMAPTIBLE_BROWSER:"incompatible_browser",NO_SERVICE_WORKER:"no_service_worker",NO_SUBDOMAIN:"no_subdomain",IOS_DEVICE:"ios_device",MICROSOFT_EDGE:"microsoft_edge",INCOGNITO:"incognito",NOTIFICATION_NOT_DEFINED:"notification_not_defined",NO_FILE_SYSTEM:"no_file_system"},f={NO_SUBSCRIBER_TOKEN:"no_subsriber_token",PERMISSION_DENIED:"permission_denied",PERMISSION_NOT_GRANTED:"permission_not_granted",INVALID_STATE_ERROR:"InvalidStateError",UNKNOWN_EVENT:"unknown_event"},g={BACK_IN_STOCK:"back_in_stock",PRICE_DROP:"price_drop"},_={SILENT:"silent",DEBUG:"debug"},b=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"parseHTML",value:function(t){var e=document.implementation.createHTMLDocument();return e.body.innerHTML=t,e.body.children[0]}},{key:"isMobile",value:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(navigator.userAgent)}},{key:"parseQueryString",value:function(t){for(var e=t.split("&"),n={},i=0;i<e.length;i++){var o=e[i].split("=");if(void 0===n[o[0]])n[o[0]]=decodeURIComponent(o[1]);else if("string"==typeof n[o[0]]){var s=[n[o[0]],decodeURIComponent(o[1])];n[o[0]]=s}else n[o[0]].push(decodeURIComponent(o[1]))}return n}},{key:"getParameterByName",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),i=n.exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}},{key:"urlB64ToUint8Array",value:function(t){for(var e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(n),o=new Uint8Array(i.length),s=0;s<i.length;++s)o[s]=i.charCodeAt(s);return o}},{key:"request",value:function(t){var e=t.method,n=void 0===e?"GET":e,i=t.url,o=t.contentType,s=void 0===o?"application/json":o,r=t.acceptType,a=void 0===r?"application/json":r,c=t.payload;return new Promise(function(t,e){var o=new XMLHttpRequest;o.open(n,i,!0),o.setRequestHeader("Content-Type",s),o.setRequestHeader("Accept",a),c?o.send(s.match(/json/)?JSON.stringify(c):c):o.send(),o.onload=function(){var n=a.match(/json/)?JSON.parse(o.responseText):o.responseText;o.status>=200&&o.status<400?t(n,o.status):e(n,o.status)}})}},{key:"getRandomString",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-",n="",i=t;i--;)n+=e[~~(Math.random()*e.length)];return n}},{key:"setCookie",value:function(t){var e=t.name,n=t.value,i=t.days,o=void 0===i?1:i,s=t.path,r=void 0===s?"/":s,a=new Date(Date.now()+864e5*o).toUTCString();document.cookie=e+"="+encodeURIComponent(n)+"; expires="+a+"; path="+r}},{key:"getCookie",value:function(t){return document.cookie.split("; ").reduce(function(e,n){var i=n.split("=");return i[0]===t?decodeURIComponent(i[1]):e},"")}},{key:"deleteCookie",value:function(t,e){setCookie(t,"",-1,e)}},{key:"isRtl",value:function(){var t=document.createElement("div");return document.body.appendChild(t),"rtl"===window.getComputedStyle(t).direction}},{key:"timezone",get:function(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(t){return null}}},{key:"browser",get:function(){var t=navigator.userAgent,e=t.search("Firefox")>=0,n=!!window.chrome,i=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,o=!!t.match(/WebKit/i),s=!!window.safari||i&&o&&!t.match(/CriOS/i);return{isSafari:s,isFirefox:e,isChrome:n,isIOS:i,name:n?l.CHROME:s?l.SAFARI:e?l.FIREFOX:l.OTHERS}}},{key:"chromeVersion",get:function(){var t=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return!!t&&parseInt(t[2],10)}}]),t}(),S=[],m={1:{title:"custom vs native prompt",isRunning:function(t){return s(1,t)},getValue:function(){return[p.ONE_STEP,p.TWO_STEP][o(1)]}},2:{title:"top-left vs top-center",isRunning:function(t){return s(2,t)},getValue:function(){return["top-left","top-center"][o(2)]}},3:{title:"35s vs 15s timeout",isRunning:function(t){return t.flags&&"enabled"===t.flags.abtest_3},getValue:function(){return[35,15][o(3)]}},4:{title:"custom (with custom config) vs native",isRunning:function(t){return t.flags&&"enabled"===t.flags.abtest_4},getValue:function(){return[{optinType:p.TWO_STEP,optinConfig:{title:"Never miss a sale 🛍️",description:"Subscribe to get updates on our new products and exclusive promotions",timeout:{default:5,mobile:10},yesButton:{label:"Allow"},noButton:{label:"Later"},position:{default:"top-center",mobile:"top"}}},{optinType:p.ONE_STEP,optinConfig:{timeout:{default:5,mobile:10}}}][o(4)]}},5:{title:"custom prompt mobile top vs bottom position",isRunning:function(t){return t.flags&&"enabled"===t.flags.abtest_5&&b.isMobile()},getValue:function(){return["top","bottom"][o(5)]}},6:{title:"custom vs native prompt (all devices)",isRunning:function(t){return t.flags&&"enabled"===t.flags.abtest_6},getValue:function(){return[p.ONE_STEP,p.TWO_STEP][o(6)]}},7:{title:"Browser prompt 5s vs 10s",isRunning:function(t){return t.flags&&"enabled"===t.flags.abtest_7},getValue:function(){return[{optinType:p.ONE_STEP,optinConfig:{timeout:5}},{optinType:p.ONE_STEP,optinConfig:{timeout:10}}][o(7)]}}},v="po_visitor",y=function(){function t(e){var n=e.endpoint,i=e.props;_classCallCheck(this,t),this.endpoint=n,this.meta={},this.initVisitor(),this.setVisitorProperties(i),this.setVisitorProperties({sessionId:b.getCookie(v),language:navigator.language})}return _createClass(t,[{key:"initVisitor",value:function(){var t=b.getCookie(v);t||(this.meta.isNewVisitor=!0,t=b.getRandomString(12),b.setCookie({name:v,value:t,duration:365})),this.visitorId=t}},{key:"setVisitorProperties",value:function(t){this.properties=_objectSpread({},this.properties,{},t)}},{key:"track",value:function(t,e){e=_objectSpread({},e,{},r()),b.request({method:"POST",url:this.endpoint,acceptType:"text/plain",payload:_objectSpread({event:t,sessionId:this.visitorId,uuid:b.getRandomString(15),properties:e},this.properties,{timestamp:(new Date).toISOString()})})}}]),t}(),w={WIDGET_CONFIG_KEY:{HOME:"home",PRICE_DROP:"price_drop",BACK_IN_STOCK:"back_in_stock"},EVENT_API_PATH:{PRICE_DROP:"price-drop",BACK_IN_STOCK:"back-in-stock"},ENVIRONMENT:{staging:"staging",production:"production"},STORAGE_KEYS:{VISITOR_TOKEN:"pushowl_visitor_token",SESSION_TOKEN:"pushowl_session_token",SUBSCRIBER_TOKEN:"pushowl_subscriber_token",SUBSCRIPTION:"pushowl_subscription",BACK_IN_STOCK_SUBSCRIPTIONS:"pushowl_back_in_stock_subscriptions",PRICE_DROP_SUBSCRIPTIONS:"pushowl_price_drop_subscriptions",SYNCED_CART_JSON:"pushowl_synced_cart_json",SYNCED_CUSTOMER_ID:"pushowl_synced_customer_id",SYNCED_AC_EVENTS:"pushowl_ac_events",SESSION_PAGEVIEW_COUNT:"pushowl_session_pageview_count",SESSION_SUBSCRIBER_CHECK:"pushowl_session_subscriber_check",OPTIN_DEFERRED_UNTIL:"pushowl_optin_deferred_until",LOG_LEVEL:"pushowl_log_level"},NOTIFICATION_PERMISSION:{DEFAULT:"default",GRANTED:"granted",DENIED:"denied",DISMISSED:"dismissed",SERVICE_WORKER_FAILURE:"service_worker_failure"},DEFAULT_TIMEOUT:{DEFAULT:0,MOBILE:10}},C={EVENTS:{CLICK:"click",ANIMATION_END:"animationend",TRANSITION_END:"transitionend"},WIDGET_CLASSES:{MINIMIZE:"minimize",MAXIMIZE:"maximize"}},T=(a={},_defineProperty(a,w.ENVIRONMENT.staging,"https://api-staging.pushowl.com"),_defineProperty(a,w.ENVIRONMENT.production,"https://api.pushowl.com"),a),E=(c={},_defineProperty(c,w.ENVIRONMENT.staging,"https://cdn-staging.pushowl.com/config"),_defineProperty(c,w.ENVIRONMENT.production,"https://cdn.pushowl.com/config"),c),O=(u={},_defineProperty(u,w.ENVIRONMENT.staging,"web.com.pushowl.staging"),_defineProperty(u,w.ENVIRONMENT.production,"web.com.pushowl.prod"),u),N={SECTIONS:{HOME:"home",COLLECTION:"collection",PRODUCT:"product",CART:"cart",CHECKOUT:"checkout",ORDER:"order",ORDERS:"orders"},PATH_ROOTS:{CART:"cart",ACCOUNT:"account",ORDERS:"orders"},DEFAULT_CHECKOUT_URL:"checkout.shopify.com"},k={SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",DEBUG:"debug"},I=1.4,x=function(){function t(e){_classCallCheck(this,t);var n=document.querySelector("body");this.config=e,this.container=n,this.node=null,this.state={title:null,buttonText:null,buttonListener:null},this.maximize=!0,this.rendered=!1}return _createClass(t,[{key:"init",value:function(){var t=this;this.node=this._createNode(),this.container.appendChild(this.node),b.isRtl()&&this.node.setAttribute("dir","rtl"),this.toast=this.node.querySelector(".pushowl-simple-toast"),this.toastContent=this.node.querySelector(".pushowl-simple-toast__content"),this.title=this.node.querySelector(".pushowl-simple-toast__title"),this.yesButton=this.node.querySelector(".pushowl-simple-toast__yes-button");var e=this.node.querySelectorAll(".action-button");this.bellButton=this.node.querySelector(".bell-button"),this.closeButton=this.node.querySelector(".close-button"),Array.from(e).forEach(function(e){e.addEventListener(C.EVENTS.CLICK,function(){t._toggleState()})})}},{key:"render",value:function(){var t=this;this.rendered||(this.init(),this.rendered=!0),this.title.textContent=this.state.title,this.state.buttonText?(this.yesButton.textContent=this.state.buttonText,this.yesButton.style.display="block",this.yesButton.addEventListener("click",function(){t.state.buttonListener&&t.state.buttonListener()})):this.yesButton.style.display="none"}},{key:"setState",value:function(t){this.state=t,this.render()}}]),t}(),P=function(t){function e(t){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))}return _inherits(e,t),_createClass(e,[{key:"_toggleState",value:function(){var t=this,e=this.maximize;this.maximize=!this.maximize,this.toast.classList[e?"add":"remove"]("is-maximized"),setTimeout(function(){t.closeButton.style.opacity=e?1:0,t.bellButton.style.opacity=e?0:1},500)}},{key:"_createNode",value:function(){var t,e=this.config.desktop,n=e.bottom,i=this.config.color;return t='<div class="pushowl-widget-node pushowl-widget-node--desktop">\n    <style>\n        .pushowl-simple-toast {\n            z-index: 2147483646;\n            bottom: '.concat(n,"px;\n            position: fixed;\n            width: 568px;\n            height: 68px;\n            box-sizing: border-box;\n            background: rgb(255, 255, 255);\n            font-family: Roboto, sans-serif;\n            display: flex;\n            align-items: center;\n            box-shadow: 2px 2px 8px 0 rgba(0,0,0,0.35);\n            left: -524px;\n            transition: left 0.5s;\n        }\n        [dir=rtl] .pushowl-simple-toast {\n            right: -524px;\n            transition-property: right;\n        }\n        .is-maximized.pushowl-simple-toast {\n            left: 0;\n        }\n        [dir=rtl] .is-maximized.pushowl-simple-toast {\n            right: 0;\n        }\n        .pushowl-simple-toast__content {\n            display: flex;\n            align-items: center;\n            width: 524px;\n            justify-content: space-between;\n        }\n        .pushowl-simple-toast__title {\n            color: rgb(51, 51, 51); \n            font-size: 13px; \n            line-height: 14px;\n            padding-left: 25px; \n            padding-right: 25px;\n        }\n\n        .pushowl-simple-toast__yes-button {\n            font-size: 14px;\n            line-height: 14px;\n            color: rgb(76, 102, 176);\n            min-width: 100px;\n            cursor: pointer;\n            text-align: right;\n            padding-left: 25px;\n            padding-right: 25px;\n            max-width: 150px;\n            letter-spacing: .3px;\n            text-transform: uppercase;\n            font-weight: 600;\n        }\n\n        .pushowl-simple-toast__action-button {\n            cursor: pointer;\n            width: 44px;\n            height: 100%;\n        }\n        \n        .pushowl-simple-toast__action-button span {\n            position: absolute;\n            width: 44px;\n            height: 100%;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            transition: opacity 0.3s;\n        }\n\n        .pushowl-simple-toast__action-button span.bell-button {\n            background-color: ").concat(i,";\n            opacity: 1;\n            border-left: 1px solid ").concat(i,';\n        }\n\n        .pushowl-simple-toast__action-button span.close-button {\n            font-size: 16px;\n            line-height: 16px;\n            color: rgb(51, 51, 51);\n            background-color: white;\n            border-left: 1px solid rgb(230, 230, 230);\n            opacity: 0;\n        }\n        .pushowl-simple-toast__action-button svg {\n            width: 14px;\n            height: 18px;\n            vertical-align: baseline;\n            transition: auto;\n        }\n        .pushowl-simple-toast__action-button .bell-button g {\n            fill: rgb(255, 255, 255);\n            transition: auto;\n        }\n    </style>\n    <div class="pushowl-simple-toast">\n        <div class="pushowl-simple-toast__content">\n            <div class="pushowl-simple-toast__title" ></div>\n            <div class="pushowl-simple-toast__yes-button"></div>\n        </div>\n        <div class="pushowl-simple-toast__action-button action-button">\n            <span class="close-button">\n                <svg width="12px" height="12px" viewBox="0 0 12 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                        \x3c!-- Generator: Sketch 43.2 (39069) - http://www.bohemiancoding.com/sketch --\x3e\n                        <defs></defs>\n                        <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                            <g id="ic_close" transform="translate(-5.000000, -5.000000)" fill="#333333">\n                                <g id="Icon-24px">\n                                    <polygon id="Shape" points="17 6.20857143 15.7914286 5 11 9.79142857 6.20857143 5 5 6.20857143 9.79142857 11 5 15.7914286 6.20857143 17 11 12.2085714 15.7914286 17 17 15.7914286 12.2085714 11"></polygon>\n                                </g>\n                            </g>\n                        </g>\n                    </svg>\n            </span>\n            <span class="bell-button">\n                <svg width="14px" height="16px" viewBox="0 0 14 16" version="1.1" xmlns="http://www.w3.org/2000/svg">\n                    <defs></defs>\n                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                        <g id="Social" transform="translate(-386.000000, -50.000000)" fill="#FFFFFF">\n                            <g id="ic_notifications" transform="translate(384.000000, 48.000000)">\n                                <g id="Icon-24px">\n                                    <path d="M9.23076923,18 C10.1333333,18 10.8717949,17.2615385 10.8717949,16.3589744 L7.58974359,16.3589744 C7.58974359,17.2615385 8.32,18 9.23076923,18 L9.23076923,18 Z M14.1538462,13.0769231 L14.1538462,8.97435897 C14.1538462,6.45538462 12.8082051,4.34666667 10.4615385,3.78871795 L10.4615385,3.23076923 C10.4615385,2.54974359 9.91179487,2 9.23076923,2 C8.54974359,2 8,2.54974359 8,3.23076923 L8,3.78871795 C5.64512821,4.34666667 4.30769231,6.44717949 4.30769231,8.97435897 L4.30769231,13.0769231 L2.66666667,14.7179487 L2.66666667,15.5384615 L15.7948718,15.5384615 L15.7948718,14.7179487 L14.1538462,13.0769231 L14.1538462,13.0769231 Z" id="Shape"></path>\n                                </g>\n                            </g>\n                        </g>\n                    </g>\n                </svg>\n            </span>\n        </div>\n    </div>\n</div>\n        '),b.parseHTML(t)}}]),e}(x),R=function(t){function e(t){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))}return _inherits(e,t),_createClass(e,[{key:"_toggleState",value:function(){var t=this.maximize;this.maximize=!this.maximize,t?(this.toastContent.style.display="block",this.toast.classList.add(C.WIDGET_CLASSES.MAXIMIZE)):(this.toastContent.style.display="none",this.toast.classList.remove(C.WIDGET_CLASSES.MAXIMIZE))}},{key:"_createNode",value:function(){var t,e=this.config.mobile,n=this.config.color;return t='\n<div class="pushowl-widget-node pushowl-widget-node--mobile">\n<style>\n    .action-button {\n        cursor: pointer;\n    }\n    \n    .bell-button {\n        position: absolute;\n        bottom: '.concat(e.bottom,"px;\n        left: ").concat(e.left,"px;\n        z-index: 2147483647;\n        width: ").concat(e.diameter,"px;\n        height: ").concat(e.diameter,"px;\n        box-sizing: border-box;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        border-radius: 50%;\n        background: ").concat(n,";\n        box-shadow: 2px 2px 8px 0 rgba(0,0,0,0.35);\n        transition: all 1s ease-in;\n    }\n    \n    \n    .close-button {\n        padding: 6px;\n        line-height: 12px;\n    }\n    \n    .pushowl-simple-toast {\n        position: fixed;\n        bottom: 0px;\n        left: 0px;\n        width: 100vw;\n        z-index: 2147483647;\n        box-sizing: border-box;\n    }\n    \n    .pushowl-simple-toast * {\n        -webkit-tap-highlight-color: rgba(0, 0, 0, 0) !important;\n    }\n    \n    .pushowl-widget-background {\n        position: absolute;\n        bottom: ").concat(e.bottom+1,"px;\n        left: 16px;\n        z-index: 2147483646;\n        width: 0px;\n        height: 0px;\n        box-sizing: border-box;\n        border-radius: 50%;\n        background: white;\n        box-shadow: 2px 2px 8px 0 rgba(0,0,0,0.35);\n        transition: all 1s ease-in;\n    }\n    \n    .pushowl-simple-toast__content {\n        box-shadow: 2px 2px 8px 0 rgba(0,0,0,0.35);\n        background: white;\n        font-family: Roboto, sans-serif;\n        padding: 13px;\n        opacity: 0;\n        transition: opacity 0.5s ease-in;\n        z-index: 2147483647;\n        visibility: collapse;\n        display: none;\n    }\n    \n    .pushowl-content-upper-section {\n        display: flex;\n        justify-content: space-between;\n    }\n\n    .pushowl-simple-toast__title {\n        color: rgb(51, 51, 51); \n        font-size: 14px; \n        line-height: 14px;\n        padding: 5px;\n        margin-right: 32px;\n    }\n\n    .pushowl-simple-toast__yes-button-container {\n        margin-top: 20px;\n        display: flex;\n        justify-content: flex-end;\n        width: 100%;\n    }\n    \n    .pushowl-simple-toast__yes-button {\n        font-size: 13px;\n        line-height: 13px;\n        color: white;\n        min-width: 100px;\n        cursor: pointer;\n        text-align: center;\n        max-width: 150px;\n        padding: 12px;\n        background-color: rgb(76, 102, 176);\n        letter-spacing: .3px;\n        border-radius: 2px;\n        text-transform: uppercase;\n    }\n  \n    /*Minimize to Maximize Transition*/\n    .maximize .bell-button {\n        animation: bell-smallitize 0.5s ease-in-out forwards, fade-out-animation 0.3s 0.6s ease-in-out forwards\n    }\n    \n    .maximize .pushowl-widget-background {\n        animation: bg-expand-animation 0.5s ease-in-out forwards, fade-out-animation 0.3s 0.6s ease-in-out forwards;\n    }\n    \n    .maximize .pushowl-simple-toast__content {\n        animation: fade-in-animation 0.3s 0.6s ease-in-out forwards;\n    }\n    \n    /* Maximize to Minimize Transition*/\n    .minimize .pushowl-simple-toast__content {\n        animation: fade-out-animation 0.3s ease-in-out forwards\n    }\n    \n    .minimize .pushowl-widget-background {\n        animation: fade-in-animation 0.3s ease-in-out forwards;\n        animation-direction: reverse;\n    }\n    \n    @keyframes fade-out-animation {\n        0% {\n            opacity: 1;\n            visibility: visible;\n        }\n        100% {\n            opacity: 0;\n            visibility: collapse;\n        }\n    }\n    \n    @keyframes fade-in-animation {\n        0% {\n            opacity: 0;\n            visibility: collapse;\n        }\n        100% {\n            opacity: 1;\n            visibility: visible;\n        }\n    }\n\n    @keyframes bell-smallitize {\n        100% {\n            left: calc(100% - ").concat(37,"px );\n            bottom: calc(100% - ").concat(37,'px);\n            width: 24px;\n            height: 24px;\n            opacity: 1;\n            box-shadow: none;\n        }\n    }\n    \n    @keyframes bg-expand-animation {\n        to {\n            position: absolute;\n            left: 0;\n            bottom: 0;\n            width: 100%;\n            height: 100%;\n            border-radius: 0;\n            background-color: white;\n            z-index: 0;\n        }\n    }\n\n    .pushowl-widget-node svg {\n        width: 14px;\n        height: 18px;\n        vertical-align: baseline;\n        transition: auto;\n    }\n    \n    .pushowl-widget-node .action-button.bell-button g {\n        fill: rgb(255, 255, 255);\n    }\n\n    .pushowl-widget-node .action-button.close-button g {\n        fill: rgb(51, 51, 51);\n    }\n</style>\n<div class="pushowl-simple-toast">\n    <div class="bell-button action-button">\n        <svg width="12px" height="12px" viewBox="0 0 14 16" version="1.1" xmlns="http://www.w3.org/2000/svg">\n            <defs></defs>\n            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                <g id="Social" transform="translate(-386.000000, -50.000000)" fill="#FFFFFF">\n                    <g id="ic_notifications" transform="translate(384.000000, 48.000000)">\n                        <g id="Icon-24px">\n                            <path d="M9.23076923,18 C10.1333333,18 10.8717949,17.2615385 10.8717949,16.3589744 L7.58974359,16.3589744 C7.58974359,17.2615385 8.32,18 9.23076923,18 L9.23076923,18 Z M14.1538462,13.0769231 L14.1538462,8.97435897 C14.1538462,6.45538462 12.8082051,4.34666667 10.4615385,3.78871795 L10.4615385,3.23076923 C10.4615385,2.54974359 9.91179487,2 9.23076923,2 C8.54974359,2 8,2.54974359 8,3.23076923 L8,3.78871795 C5.64512821,4.34666667 4.30769231,6.44717949 4.30769231,8.97435897 L4.30769231,13.0769231 L2.66666667,14.7179487 L2.66666667,15.5384615 L15.7948718,15.5384615 L15.7948718,14.7179487 L14.1538462,13.0769231 L14.1538462,13.0769231 Z" id="Shape"></path>\n                        </g>\n                    </g>\n                </g>\n            </g>\n        </svg>\n    </div>\n    <div class="pushowl-widget-background"></div>\n    <div class="pushowl-simple-toast__content">\n        <div class="pushowl-content-upper-section">\n            <div class="pushowl-simple-toast__title" ></div>\n            <div class="action-button close-button" >\n                <svg width="12px" height="12px" viewBox="0 0 12 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                    \x3c!-- Generator: Sketch 43.2 (39069) - http://www.bohemiancoding.com/sketch --\x3e\n                    <defs></defs>\n                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                        <g id="ic_close" transform="translate(-5.000000, -5.000000)" fill="#333333">\n                            <g id="Icon-24px">\n                                <polygon id="Shape" points="17 6.20857143 15.7914286 5 11 9.79142857 6.20857143 5 5 6.20857143 9.79142857 11 5 15.7914286 6.20857143 17 11 12.2085714 15.7914286 17 17 15.7914286 12.2085714 11"></polygon>\n                            </g>\n                        </g>\n                    </g>\n                </svg>\n\n            </div>\n        </div>\n        <div class="pushowl-simple-toast__yes-button-container">\n            <div class="pushowl-simple-toast__yes-button"></div>\n        </div>\n    </div>\n\n</div>\n</div>\n    '),b.parseHTML(t)}}]),e}(x),A=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"getServiceWorkerUrlWithIntergrations",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.keys(e).filter(function(t){return"enabled"===e[t].status});if(!n.length)return t;var i=new URL(t).search;return"".concat(t).concat(i?"&":"?","integrations=").concat(n.join(","))}},{key:"scriptUrl",get:function(){for(var e=document.getElementsByTagName("script"),n=0;n<e.length;n++){var i=e[n].src||"";if(i.indexOf("pushowl-".concat("headless"===t.mode?"sdk":"shopify",".js"))>-1)return i}}},{key:"environment",get:function(){var e=b.parseQueryString(new URL(t.scriptUrl).search.substring(1)),n=e.environment;return n&&(n=w.ENVIRONMENT[n]),n||w.ENVIRONMENT.production}},{key:"isProduction",get:function(){return t.environment==w.ENVIRONMENT.production}},{key:"apiEndpoint",get:function(){return T[t.environment]}},{key:"configApiEndpoint",get:function(){return E[t.environment]}},{key:"subdomain",get:function(){return b.parseQueryString(new URL(t.scriptUrl).search.substring(1)).subdomain}},{key:"guid",get:function(){return b.parseQueryString(new URL(t.scriptUrl).search.substring(1)).guid}},{key:"shopUrl",get:function(){return location.protocol+"//"+location.host}},{key:"serviceWorkerUrl",get:function(){return"headless"===t.mode?"".concat(t.shopUrl,"/pushowl/service-worker.js?v=2&subdomain=").concat(this.subdomain):"".concat(t.shopUrl,"/apps/pushowl/sdks/service-worker.js?v=2&subdomain=").concat(this.subdomain)}},{key:"webPushId",get:function(){return O[this.environment]||O[w.ENVIRONMENT.production]}},{key:"webServiceUrl",get:function(){return"".concat(t.apiEndpoint,"/safari/").concat(t.subdomain)}}]),t}(),L=function(){function t(e){_classCallCheck(this,t),this.config=e,this.node=null,this.container=document.body,this.state={title:null,description:null,yesButtonText:"",noButtonText:"",theme:{},yesButtonListener:null,noButtonListener:null,branding:!0,logo:null,position:{default:"top-center",mobile:"top"}},this.rendered=!1}return _createClass(t,[{key:"init",value:function(){var t=this;this.node=this._createNode(),this.container.appendChild(this.node),this.title=this.node.querySelector(".js-pushowl-title"),this.description=this.node.querySelector(".js-pushowl-description"),this.yesButton=this.node.querySelector(".js-pushowl-yes-button"),this.noButton=this.node.querySelector(".js-pushowl-no-button");var e=0;window.addEventListener("click",function(n){return Date.now()-e<1e3||(t.clickHandler(n),!0)},!0),window.addEventListener("touchend",function(n){return e=Date.now(),t.clickHandler(n),!0},!0)}},{key:"clickHandler",value:function(t){var e=t.target;this.yesButton.contains(e)?this.state.yesButtonListener&&this.state.yesButtonListener():this.noButton.contains(e)&&this.state.noButtonListener&&this.state.noButtonListener()}},{key:"getPositionCss",value:function(t){switch(t){case"top-center":return"\n        top: 0 !important;\n        left: calc(50vw - ".concat(210,"px) !important;\n      ");case"top-left":return"\n        top: 0 !important;\n        left: 0 !important;\n      ";case"top-right":return"\n        top: 0 !important;\n        right: 0 !important;\n      ";case"bottom-center":return"\n        bottom: 0 !important;\n        left: calc(50vw - ".concat(210,"px) !important;\n      ");case"bottom-left":return"\n        bottom: 0 !important;\n        left: 0 !important;\n      ";case"bottom-right":return"\n        bottom: 0 !important;\n        right: 0 !important;\n      ";case"top":return"\n        top: 0 !important;\n        bottom: auto !important;\n        left: 0 !important;\n      ";case"bottom":return"\n        top: auto !important;\n        bottom: 0 !important;\n        left: 0 !important;\n      ";default:return""}}},{key:"render",value:function(){this.rendered||(this.init(),this.rendered=!0),this.title.textContent=this.state.title,this.description.textContent=this.state.description,this.yesButton.textContent=this.state.yesButton.label,this.noButton.textContent=this.state.noButton.label}},{key:"setState",value:function(t){var e={};Object.keys(t).filter(function(e){return void 0!==t[e]}).map(function(n){return e[n]=t[n]}),this.state=_objectSpread({},this.state,{},e),this.render()}},{key:"destroy",value:function(){this.node.remove()}},{key:"_createNode",value:function(){
var t,e=this.state.theme.yesButtonBgColor||"hsl(223, 71%, 52%)",n=this.state.theme.yesButtonColor||"white";return t="<div>\n    <style>\n        .pushowl-optin {\n            all: initial;\n            display: block;\n            z-index: 2147483647 !important;\n            position: fixed !important;\n            width: ".concat(420,"px !important;\n            margin: ").concat(12,"px !important;\n            box-sizing: border-box !important;\n            background: rgb(255, 255, 255) !important;\n            border-radius: 4px !important;\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif !important;\n            align-items: center !important;\n            font-size: 14px !important;\n            box-shadow: 0px 12px 13px rgba(0, 0, 0, 0.21)!important;\n            ").concat(this.getPositionCss(this.state.position.default),"\n        }\n        .pushowl-optin * {\n            width: initial !important;\n            font-family: inherit !important;\n            letter-spacing: initial !important;\n            box-sizing: border-box !important;\n            line-height: initial !important;\n            font-weight: normal !important;\n            -webkit-font-smoothing: initial !important;\n            text-shadow: initial !important;\n            border: initial !important;\n        }\n        .pushowl-optin svg {\n          width: initial;\n          height: initial;\n          stroke: initial;\n          fill: initial;\n        }\n        @media screen and (max-width: ").concat(444,"px) {\n            .pushowl-optin {\n                width: calc(100% - ").concat(24,"px) !important;\n                ").concat(this.getPositionCss(this.state.position.mobile),"\n            }\n        }\n        .pushowl-optin__content {\n            padding: 16px !important;\n        }\n        .pushowl-optin__title {\n            text-transform: initial !important;\n            text-align: initial !important;\n            letter-spacing: 0.3px !important;\n            font-size: 16px !important;\n            margin-top: 0 !important;\n            margin-bottom: 8px !important;\n            color: #343946 !important;\n            font-weight: 500 !important;\n            padding: 0 !important;\n        }\n        .pushowl-optin__description {\n            color: #637381 !important;\n            margin: 0 !important;\n            padding: 0 !important;\n            font-size: inherit !important;\n        }\n        .pushowl-optin__image {\n            border-radius: 50% !important;\n            flex-shrink: 0 !important;\n            margin-right: 16px !important;\n            padding: 8px !important;\n        }\n        .pushowl-optin__image img {\n          width: 40px !important;\n        }\n        .pushowl-optin__button {\n            width: initial !important;\n            min-width: initial !important;\n            height: initial !important;\n            min-height: initial !important;\n            text-transform: initial !important;\n            margin: initial !important;\n            cursor: pointer !important;\n            font-size: inherit !important;\n            padding: 6px 20px !important;\n            max-width: 150px !important;\n            border-radius: 4px !important;\n            border: none !important;\n        }\n        .pushowl-optin__yes-button {\n            background: ").concat(e," !important;\n            color: ").concat(n,' !important;\n        }\n        .pushowl-optin__no-button {\n            background: transparent !important;\n            border: 0 !important;\n            color: #637381 !important;\n        }\n        .pushowl-optin__footer {\n            display: flex !important;\n            justify-content: flex-end !important;\n            align-items: center !important;\n            margin-top: 16px !important;\n        }\n        .pushowl-optin__footer-btn-wrap {\n          display: flex !important;\n          align-items: center !important;\n        }\n    </style>\n    <div class="pushowl-optin">\n        <div class="pushowl-optin__content">\n            <div style="display:flex;align-items:flex-start;">\n                <div class="pushowl-optin__image">\n                    ').concat(this.state.logo?'<img src="'.concat(this.state.logo,'" alt="" />'):'<svg width="40" height="42" fill="none" xmlns="http://www.w3.org/2000/svg"><ellipse cx="20" cy="2.53" rx="2" ry="2.024" fill="#E5843B"/><path d="M.265 34.41h39.47a.18.18 0 00.167-.247l-5.264-13.241a42.729 42.729 0 01-2.395-8.492l-.162-.936a12.261 12.261 0 00-24.162 0l-.162.936a42.723 42.723 0 01-2.395 8.492L.098 34.162a.18.18 0 00.167.247z" fill="#F8CE53"/><ellipse cx="20" cy="34.916" rx="20" ry="7.084" fill="#ECA248"/><mask id="a" maskUnits="userSpaceOnUse" x="0" y="27" width="40" height="15"><ellipse cx="20" cy="34.916" rx="20" ry="7.084" fill="#ECA248"/></mask><g mask="url(#a)"><ellipse cx="20" cy="28.084" rx="7" ry="7.084" fill="#E5843B"/></g></svg>','\n                </div>\n                <div style="flex:1">\n                    <h2 class="js-pushowl-title pushowl-optin__title"></h2>\n                    <p class="js-pushowl-description pushowl-optin__description">Description will come here...</p>\n                </div>\n            </div>\n            <div class="pushowl-optin__footer">\n                <div class="pushowl-optin__footer-btn-wrap">\n                    <button class="js-pushowl-no-button pushowl-optin__button pushowl-optin__no-button">Later</button>\n                    <button class="js-pushowl-yes-button pushowl-optin__button pushowl-optin__yes-button">Allow</button>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n        '),b.parseHTML(t)}}]),t}(),M=function(){function t(){_classCallCheck(this,t),this.product=null}return _createClass(t,[{key:"getProductDetails",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]}},{key:"getRawCurrentProductDetails",value:function(){}}],[{key:"getCart",value:function(){}},{key:"section",get:function(){}},{key:"productAlias",get:function(){}},{key:"customerId",get:function(){}}]),t}(),D=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"currentVariant",value:function(){}}]),t}(),B=function t(){_classCallCheck(this,t)},H=function(t){function e(t){var n;return _classCallCheck(this,e),n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this)),n.id=t.id,n.name=t.name,n.price=t.price/100,n.available=t.available,n}return _inherits(e,t),e}(B),F=function(t){function e(t){var n;_classCallCheck(this,e),n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this)),n.id=t.id,n.title=t.title;var i=t.variants;return n.variants=i.map(function(t){return new H(t)}),n}return _inherits(e,t),_createClass(e,[{key:"getVariant",value:function(t){return t=parseInt(t),this.variants.find(function(e){return e.id==t})}},{key:"currentVariant",value:function(){var t=b.getParameterByName("variant");if(t)return this.getVariant(t);var e=!0,n=!1,i=void 0;try{for(var o,s=this.variants[Symbol.iterator]();!(e=(o=s.next()).done);e=!0){var r=o.value;if(r.available)return r}}catch(t){n=!0,i=t}finally{try{e||null==s.return||s.return()}finally{if(n)throw i}}return this.variants[0]}}]),e}(D),U=function(t){function e(){var t;return _classCallCheck(this,e),t=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this)),t.productCache={},t}return _inherits(e,t),_createClass(e,[{key:"getProductDetails",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1?arguments[1]:void 0,o=i||e.productAlias;return this.productCache[o]&&!n?Promise.resolve(this.productCache[o]):b.request({url:"/products/".concat(o,".js")}).then(function(e){return t.productCache[o]=new F(e)})}},{key:"getRawCurrentProductDetails",value:function(){return Promise.resolve(window.ShopifyAnalytics.meta.product)}}],[{key:"getCart",value:function(){return b.request({url:"/cart.js?random=".concat(Date.now())}).then(function(t){return t.updated_at=(new Date).toISOString(),t},function(){return"Cart API failed"})}},{key:"section",get:function(){try{var t=window.ShopifyAnalytics.meta.page.pageType;if(t)return t}catch(t){}var e=location.hostname,n=location.pathname,i=n.split("/")[0],o=n.split("/")[1];if(""===i)return N.SECTIONS.HOME;if(i===N.PATH_ROOTS.CART)return N.SECTIONS.CART;if(i===N.PATH_ROOTS.ACCOUNT&&o===N.PATH_ROOTS.ORDERS)return N.SECTIONS.ORDER;if("account"===i&&!i)return N.SECTIONS.ORDERS;if("checkout.shopify.com"===e||"checkouts"===o||n.indexOf("checkouts")>=0)return N.SECTIONS.CHECKOUT;if("undefined"!=typeof __st&&__st.s){var s=__st.s,r=s.split("-")[0];if("collections"===r)return N.SECTIONS.COLLECTION;if("products"===r)return N.SECTIONS.PRODUCT}}},{key:"productAlias",get:function(){var t=location.pathname,e=t.split("/");e=e.filter(function(t){return t});var n=e.findIndex(function(t){return"products"===t.toLowerCase()});return-1===n?"":e[n+1]}},{key:"customerId",get:function(){if("headless"===A.mode)return window.pushowl?window.pushowl.customerId:"";var t=null;return"undefined"!=typeof __st&&__st.cid?t=__st.cid:void 0!==Shopify.checkout&&Shopify.checkout.customer_id&&(t=Shopify.checkout.customer_id.toString()),t}}]),e}(M),j=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"cartId",get:function(){}}]),t}(),V=function(t){function e(t){var n;return _classCallCheck(this,e),n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this)),n.token=t.token,n.checkout_token=t.checkout_token,n.item_count=t.item_count,n.items=t.items,n}return _inherits(e,t),_createClass(e,[{key:"cartId",get:function(){var t=[this.token||this.checkout_token||""],e=[],n={},i=!0,o=!1,s=void 0;try{for(var r,a=this.items[Symbol.iterator]();!(i=(r=a.next()).done);i=!0){var c=r.value;e.push(c.variant_id),n[c.variant_id]=c.quantity}}catch(t){o=!0,s=t}finally{try{i||null==a.return||a.return()}finally{if(o)throw s}}e=e.sort(function(t,e){return t-e});var u=!0,l=!1,p=void 0;try{for(var d,h=e[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){var f=d.value,g=n[f];t.push("".concat(f,":").concat(g))}}catch(t){l=!0,p=t}finally{try{u||null==h.return||h.return()}finally{if(l)throw p}}return t.concat(t).join("-")}}]),e}(j),G={decodeBase64Id:function(t){if(t&&"string"==typeof t){var e=t.split("::").shift();return window.atob(e).replace(/\?.*/,"").split("/").pop()}return t},detectAjaxCartUpdate:function(t){var e=window.XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=function(n,i){this.addEventListener("readystatechange",function(){var e=n.toUpperCase();("GET"===e&&"/cart/add.js"===i||"POST"===e&&("/cart/add.js"===i||"/cart/update.js"===i||"/cart/change.js"===i))&&4===this.readyState&&"function"==typeof t&&t()}),e.apply(this,arguments)}},detectAjaxCartUpdate2:function(t){var e=window.fetch;window.fetch=function(){var n=arguments.length<=0?void 0:arguments[0],i=e.apply(void 0,arguments);return n.match(/api\/.*\/graphql/)?(i.then(function(t){return t.clone()}).then(function(e){try{e.json().then(function(e){var n;if(e&&e.data&&(e.data.checkoutLineItemsUpdate&&e.data.checkoutLineItemsUpdate.checkout?n=e.data.checkoutLineItemsUpdate.checkout:e.data.checkoutLineItemsAdd&&e.data.checkoutLineItemsAdd.checkout&&(n=e.data.checkoutLineItemsAdd.checkout),n)){var i=n.lineItems.edges.map(function(t){return{variant_id:parseInt(G.decodeBase64Id(t.node.variant.id),10),product_id:parseInt(G.decodeBase64Id(t.node.variant.product.id),10),quantity:t.node.quantity}});"function"==typeof t&&t({checkout_token:G.decodeBase64Id(n.id),item_count:i.length,items:i,updated_at:(new Date).toISOString()})}})}catch(t){}}),i):i}},detectAjaxCartUpdate3:function(t){var e=window.fetch;window.fetch=function(){var n=(arguments.length<=0?void 0:arguments[0])||"",i=(arguments.length<=1?void 0:arguments[1])||{},o=i.method||"GET",s=e.apply(void 0,arguments);return("GET"===o&&n.includes("/cart/add.js")||"POST"===o&&(n.includes("/cart/add.js")||n.includes("/cart/update.js")||n.includes("/cart/change.js")))&&s.then(function(){t()}),s}}},K=function(){function t(e){_classCallCheck(this,t),this.key=e,window.localStorage.getItem(e)?this.subscriptions=window.localStorage.getItem(this.key).split(","):this.subscriptions=[]}return _createClass(t,[{key:"subscribe",value:function(t){this.isSubscribed(t)||(this.subscriptions.push(t.id.toString()),window.localStorage[this.key]=this.subscriptions)}},{key:"isSubscribed",value:function(t){return this.subscriptions.indexOf(t.id.toString())>-1}}]),t}(),z=function(){function t(){_classCallCheck(this,t),this.back_in_stock=new K(w.STORAGE_KEYS.BACK_IN_STOCK_SUBSCRIPTIONS),this.price_drop=new K(w.STORAGE_KEYS.PRICE_DROP_SUBSCRIPTIONS)}return _createClass(t,null,[{key:"getOrCreateToken",value:function(t,e){var n=t.getItem(e);if(n)return n;var i=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},o=(i()+i()+"-"+i()+"-4"+i().substr(0,3)+"-"+i()+"-"+i()+i()+i()).toLowerCase();return t.setItem(e,o),o}},{key:"handlePostSubscription",value:function(e,n){t.subscription=e,t.subscriberToken=n}},{key:"subscriberToken",get:function(){return localStorage.getItem(w.STORAGE_KEYS.SUBSCRIBER_TOKEN)},set:function(t){localStorage.setItem(w.STORAGE_KEYS.SUBSCRIBER_TOKEN,t)}},{key:"visitorToken",get:function(){return this.getOrCreateToken(localStorage,w.STORAGE_KEYS.VISITOR_TOKEN)}},{key:"sessionToken",get:function(){return this.getOrCreateToken(sessionStorage,w.STORAGE_KEYS.SESSION_TOKEN)}},{key:"syncedCustomerId",get:function(){return localStorage.getItem(w.STORAGE_KEYS.SYNCED_CUSTOMER_ID)},set:function(t){localStorage.setItem(w.STORAGE_KEYS.SYNCED_CUSTOMER_ID,t.toString())}},{key:"synced_cart_json",get:function(){var t=localStorage.getItem(w.STORAGE_KEYS.SYNCED_CART_JSON);return t?JSON.parse(t):void 0},set:function(t){t&&("[object String]"!==Object.prototype.toString.call(t)&&(t=JSON.stringify(t)),localStorage.setItem(w.STORAGE_KEYS.SYNCED_CART_JSON,t))}},{key:"ac_events",get:function(){try{return JSON.parse(localStorage.getItem(w.STORAGE_KEYS.SYNCED_AC_EVENTS))||[]}catch(t){return[]}},set:function(t){var e="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(w.STORAGE_KEYS.SYNCED_AC_EVENTS,e)}},{key:"subscription",get:function(){var t=localStorage.getItem(w.STORAGE_KEYS.SUBSCRIPTION),e=null;if(t)try{e=JSON.parse(t)}catch(t){e=null}return e},set:function(t){var e="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(w.STORAGE_KEYS.SUBSCRIPTION,e)}},{key:"optinDeferredUntil",get:function(){return parseInt(localStorage.getItem(w.STORAGE_KEYS.OPTIN_DEFERRED_UNTIL)||0,10)},set:function(t){localStorage.setItem(w.STORAGE_KEYS.OPTIN_DEFERRED_UNTIL,t)}},{key:"logLevel",get:function(){return localStorage.getItem(w.STORAGE_KEYS.LOG_LEVEL)},set:function(t){localStorage.setItem(w.STORAGE_KEYS.LOG_LEVEL,t)}}]),t}(),W=function(){function t(){_classCallCheck(this,t),this.configKey="pushowl_shopify_config-".concat(I,"-").concat(A.guid),this.permissionKey="pushowl_permission_not_granted-".concat(I,"-").concat(A.guid),this.subscriptionVerifiedKey="pushowl_subscription_verified-".concat(I,"-").concat(A.guid),this.optinSeenCountKey="pushowl_optin_seen_count"}return _createClass(t,[{key:"config",get:function(){var t=window.sessionStorage.getItem(this.configKey),e=null;if(t)try{e=JSON.parse(t)}catch(t){e=null}return e},set:function(t){var e="string"==typeof t?t:JSON.stringify(t);window.sessionStorage.setItem(this.configKey,e)}},{key:"isPermissionNotGranted",get:function(){return"true"===window.sessionStorage.getItem(this.permissionKey)},set:function(t){window.sessionStorage.setItem(this.permissionKey,t)}},{key:"subscriptionVerified",get:function(){return!!window.sessionStorage.getItem(this.subscriptionVerifiedKey)},set:function(t){window.sessionStorage.setItem(this.subscriptionVerifiedKey,t)}},{key:"optinSeenCount",get:function(){return parseInt(window.sessionStorage.getItem(this.optinSeenCountKey)||0,10)},set:function(t){window.sessionStorage.setItem(this.optinSeenCountKey,t)}}]),t}(),q=function(){function t(){_classCallCheck(this,t);var e=A.subdomain;this.endpoint=A.apiEndpoint,this.config_endpoint="".concat(A.configApiEndpoint,"/api/v1/shopify/").concat(e,"/config/widget/"),this.subscriber_endpoint="".concat(this.endpoint,"/api/v1/accounts/").concat(e,"/subscriber/"),this.subscriber_refresh_endpoint="".concat(this.endpoint,"/api/v2/accounts/").concat(e,"/subscriber/refresh/"),this.event_endpoint="".concat(this.endpoint,"/api/v1/shopify/").concat(e,"/subscriber/event"),this.cart_sync_endpoint="".concat(this.endpoint,"/api/v2/shopify/").concat(e,"/subscriber/event/cart-sync/"),this.product_view_endpoint="".concat(this.endpoint,"/api/v1/shopify/").concat(e,"/subscriber/event/product-view/"),this.unsubscribe_endpoint="".concat(this.endpoint,"/api/v1/accounts/").concat(e,"/unsubscribe/"),this.debug_endpoint="".concat(this.endpoint,"/api/v1/shopify/").concat(e,"/debug/"),this.checkout_sync_endpoint="".concat(this.endpoint,"/api/v1/shopify/").concat(e,"/subscriber/event/checkout-sync/")}return _createClass(t,[{key:"post",value:function(t,e){return b.request({method:"POST",url:t,payload:e})}},{key:"config",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1],"".concat(this.config_endpoint,"?guid=").concat(A.guid));return b.request({url:t})}},{key:"sendSubscription",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=new W,o={subscription:t,browser:b.browser.name,previous_token:z.subscriberToken,website_push_id:n||A.webPushId,customer_id:i.config.privacy?U.customerId:null,language:window.navigator.language,timezone:b.timezone,dispatch_method:"vapid",user_agent:navigator.userAgent,guid:A.guid,optin_seen_count:i.optinSeenCount,context:{is_resync:e,subscribe_url:window.location.href,session_token:z.sessionToken,visitor_token:z.visitorToken,widget_source:window.poSubscriptionSource}},s=r();return o.context=_objectSpread({},o.context,{},s),b.request({method:"POST",url:this.subscriber_endpoint,payload:o}).then(function(t){return t.result.token},function(){return"Send Subscription API Failed"})}},{key:"refreshSubscription",value:function(t,e,n){var i={previous_token:t,previous_subscription:e,current_subscription:n};return i.context={subscribe_url:window.location.href,session_token:z.sessionToken,visitor_token:z.visitorToken},b.request({method:"POST",url:this.subscriber_refresh_endpoint,payload:i}).then(function(t){return t.result.token},function(){return"Refresh Subscription API Failed"})}},{key:"syncSubscriber",value:function(){var t={data:[{key:"customer_id",value:U.customerId}],token:z.subscriberToken,context:{subscribe_url:window.location.href,session_token:z.sessionToken,visitor_token:z.visitorToken}};return b.request({method:"PUT",url:this.subscriber_endpoint,payload:t})}},{key:"syncCart",value:function(t,e){var n=new W,i={subscriber_token:z.subscriberToken,customer_id:n.config.privacy?e||U.customerId:null,browser:b.browser.name,cart_json:t};return b.request({method:"POST",url:this.cart_sync_endpoint,payload:i}).then(function(t){return t.status>=200&&t.status<400?t:Promise.reject()})}},{key:"syncProductView",value:function(t){var e={subscriber_token:z.subscriberToken,session:z.sessionToken,viewed_time:~~(Date.now()/1e3),product_data:t};return b.request({method:"POST",url:this.product_view_endpoint,payload:e}).then(function(t){return t.status>=200&&t.status<400?t:Promise.reject()})}},{key:"sendEvent",value:function(t,e){var n="".concat(this.event_endpoint,"/").concat(t,"/");return b.request({method:"POST",url:n,payload:e}).then(function(t){return t},function(){return"Event Update failed"})}},{key:"unsubscribe",value:function(t){return this.post(this.unsubscribe_endpoint,{token:t})}},{key:"syncSubscriberTokenAndCheckoutId",value:function(t){var e=JSON.stringify({subscriber_token:z.subscriberToken,checkout_token:t});navigator.sendBeacon(this.checkout_sync_endpoint,e)}},{key:"debugLog",value:function(t){return this.post(this.debug_endpoint,t)}}]),t}(),Y=function t(e){_classCallCheck(this,t),this.inclusions=e.inclusions,this.exclusions=e.exclusions},Z=function(){function e(t){_classCallCheck(this,e),this.url=new Y(t.url)}return _createClass(e,[{key:"processCondition",value:function(t,e){var n=e.inclusions,i=e.exclusions;return n.some(function(e){return new RegExp(e).test(t)})&&!i.some(function(e){return new RegExp(e).test(t)})}},{key:"processUrlActivationRule",value:function(){try{var e=this.url,n=window.location.href,i=this.processCondition(n,e);return t("[Checking page url condition]","Condition: ",this.url," / Result: ".concat(i?"✅":"❌")),i}catch(t){return!0}}}]),e}(),J=function t(e){_classCallCheck(this,t),this.native_pop_up=new ct(e.native_pop_up),this.flyout=new at(e.flyout)},X=function t(e){_classCallCheck(this,t),this.type=e.type,e.config&&(this.config=e.config,this.config.overlay=new Q(this.config.overlay))},Q=function t(e){_classCallCheck(this,t),this.enabled=e.enabled,this.title=e.title,this.subtitle=e.description,this.branding=e.branding},$=function t(e){_classCallCheck(this,t),this.money_format=e.money_format},tt=function t(e){_classCallCheck(this,t),this.enabled=e.enabled,this.text=e.text},et=function t(e){_classCallCheck(this,t),this.unsubscribe=new tt(e.unsubscribe),this.access_data=new tt(e.access_data),this.delete_data=new tt(e.delete_data)},nt=function t(e){_classCallCheck(this,t),this.enabled=e.enabled,this.message=e.message,this.actions=new et(e.actions)},it=function t(e){_classCallCheck(this,t),this.notification_preference=new nt(e.notification_preference),this.customer_id=e.customer_id},ot=function t(e){_classCallCheck(this,t),this.bottom=e.bottom||15},st=function t(e){_classCallCheck(this,t),this.bottom=e.bottom||15,this.left=e.left||15,this.diameter=e.diameter||48},rt=function t(e){_classCallCheck(this,t),this.desktop=new ot(e.desktop),this.mobile=new st(e.mobile),this.color=e.color||"rgb(51, 51, 51)",this.overlay=e.overlay},at=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),this.enabled=e.enabled,this.title=e.title,this.buttonText=e.button_text||e.buttonText,this.postSubscriptionTitle=e.post_subscription_message||e.postSubscriptionTitle}return _createClass(t,null,[{key:"create_instance",value:function(e){var n=new t;n.enabled=e.enabled;var i=e.metadata;return n.title=e.title||i.title,n.buttonText=e.buttonText||i.yes_button.text,n.postSubscriptionTitle=e.postSubscriptionTitle||i.post_subscription.post_subscription_widget.title,n}}]),t}(),ct=function t(e){_classCallCheck(this,t),this.enabled=e.enabled,this.timeout=new ut(e.timeout),this.hint_screen=new Q(e.hint_screen)},ut=function t(e){_classCallCheck(this,t),this.default=e.hasOwnProperty(["default"])?parseInt(e.default):w.DEFAULT_TIMEOUT.DEFAULT,this.mobile=e.hasOwnProperty(["mobile"])?parseInt(e.mobile):w.DEFAULT_TIMEOUT.MOBILE},lt=function(){function t(e){_classCallCheck(this,t),e=this.preProcess(e),this.home=new J(e.home),this.optin=e.optin?new X(e.optin):null,this.price_drop=at.create_instance(e.price_drop),this.back_in_stock=at.create_instance(e.back_in_stock),this.shop=new $(e.shop),this.abandoned_cart_enabled=e.abandoned_cart_enabled,this.browse_abandonment_enabled=e.browse_abandonment_enabled,this.optin_report_enabled=e.optin_report_enabled,this.is_beta=e.is_beta||!1,this.privacy=new it(e.privacy),this.vapid_public_key=e.vapid_public_key,this.activation_rule=e.activation_rule&&new Z(e.activation_rule),this.flyout_config=e.flyout_config&&new rt(e.flyout_config),this.branding=void 0===e.branding||e.branding,this.logo=e.logo,this.flags=e.flags,this.wid=e.wid,this.integrations=e.integrations,this.website_push_id=e.website_push_id}return _createClass(t,[{key:"preProcess",value:function(t){var e=void 0===t.branding||t.branding;return t.optin&&t.optin.config&&t.optin.config.overlay&&(t.optin.config.overlay.branding=e),t.home.native_pop_up&&t.home.native_pop_up.hint_screen&&(t.home.native_pop_up.hint_screen.branding=e),t}}]),t}(),pt=function(){function e(t){var n=t.websitePushId;_classCallCheck(this,e),this.subdomain=A.subdomain,this.webPushId=n||A.webPushId,this.webServiceUrl=A.webServiceUrl,this.getSubscription=this.getSubscription.bind(this)}return _createClass(e,[{key:"getSubscription",value:function(){var e=this;return new Promise(function(n,i){var o=window.safari.pushNotification.permission(e.webPushId);!function o(s){t("PermissionData:",s.permission),"default"===s.permission?window.safari.pushNotification.requestPermission(e.webServiceUrl,e.webPushId,{domain:window.location.origin},o):"denied"===s.permission?i(w.NOTIFICATION_PERMISSION.DENIED):"granted"===s.permission&&n(s.deviceToken)}(o)})}}]),e}(),dt=function(){function e(t){var n=t.vapidPublicKey,i=t.integrations;_classCallCheck(this,e),this.getSubscription=this.getSubscription.bind(this),this.vapid_public_key=n,this.integrations=i}return _createClass(e,[{key:"getSubscription",value:function(){var e=this;return new Promise(function(i,o){Notification.requestPermission().then(function(s){if(s===w.NOTIFICATION_PERMISSION.GRANTED){var r={};e.integrations&&e.integrations.edgemesh&&"enabled"===e.integrations.edgemesh.status&&(r.scope="/"),navigator.serviceWorker.register(A.getServiceWorkerUrlWithIntergrations(A.serviceWorkerUrl,e.integrations),r).then(function(n){var s;"/"===r.scope?navigator.serviceWorker.getRegistrations().then(function(e){e.forEach(function(e){e.scope.match(/pushowl\/sdks\//)&&(e.unregister(),t("Found stale service worker on subpath scope",e))})}):navigator.serviceWorker.getRegistrations().then(function(e){e.forEach(function(e){e.active&&e.active.scriptURL.match(/pushowl/)&&!e.scope.match(/pushowl\/sdks\//)&&(e.unregister(),t("Found stale service worker on root scope",e))})}),n.installing?s=n.installing:n.waiting?s=n.waiting:n.active&&(s=n.active),s&&("activated"===s.state?e._serviceWorkerSubscriber(n,i,o):s.addEventListener("statechange",function(t){"activated"===t.target.state&&e._serviceWorkerSubscriber(n,i,o)}))}).catch(function(t){n(t),o(t)})}else s!==w.NOTIFICATION_PERMISSION.DENIED&&s!==w.NOTIFICATION_PERMISSION.DEFAULT||o(s)})})}},{key:"_serviceWorkerSubscriber",value:function(t,e,i){var o=this,s={userVisibleOnly:!0,applicationServerKey:b.urlB64ToUint8Array(this.vapid_public_key)};t.pushManager.subscribe(s).then(function(t){e(t)}).catch(function(s){s.toString().indexOf("InvalidStateError")>=0?t.pushManager.getSubscription().then(function(n){n.unsubscribe().then(function(n){t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:b.urlB64ToUint8Array(o.vapid_public_key)}).then(function(t){e(t)}).catch(function(t){i(t)})}).catch(function(t){i(t)})}):(n(s),i(s))})}}]),e}(),ht=function(){function t(e,n,i){if(_classCallCheck(this,t),this.getSubscription=null,b.browser.isSafari){var o=new pt({websitePushId:i});this.getSubscription=o.getSubscription}else{var s=new dt({vapidPublicKey:e,integrations:n});this.getSubscription=s.getSubscription}}return _createClass(t,[{key:"isPermissionGranted",get:function(){return Notification.permission===w.NOTIFICATION_PERMISSION.GRANTED}}]),t}();!function(o){var s=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),this.hintscreen=new PushowlHintScreen({onDismiss:n.onDismiss}),this.enabled=e}return _createClass(t,[{key:"show",value:function(t){var e=PO_HS_CONSTANTS.SCREENS;this.hintscreen.purge(),this.enabled&&!b.browser.isSafari&&(Notification.permission===w.NOTIFICATION_PERMISSION.DEFAULT&&this.hintscreen.render(e.GRANT_PERMISSION,t),Notification.permission===w.NOTIFICATION_PERMISSION.DENIED&&this.hintscreen.render(e.DENIED_PERMISSION),Notification.permission===w.NOTIFICATION_PERMISSION.GRANTED&&this.hintscreen.purge())}},{key:"purge",value:function(){this.hintscreen.purge()}}]),t}(),r=function(){function r(){var t=this;_classCallCheck(this,r);var i=A.scriptUrl,s=b.parseQueryString(new URL(i).search.substring(1));this.subdomain=s.subdomain,this.environment=A.environment,this.apiEndpoint=A.apiEndpoint,this.apiClient=new q,this.webPushId=A.webPushId,this.webServiceUrl=A.webServiceUrl,this.config=null,this.storageManager=new z,this.sessionManager=new W,this.storeLib=new U,this.subscriberTokenExists=!!z.subscriberToken,this.tokenType=this.subscriberTokenExists?"subscriber":"visitor",this.tokenValue=this.subscriberTokenExists?z.subscriberToken:z.visitorToken,this.customLog=console;var a;o.sessionStorage&&navigator.serviceWorker&&(a=this.getConfig(),a.then(function(n){t.config=n,e("Status",{ACR:n.abandoned_cart_enabled?"🟢":"🔴","Browse abandonment":n.browse_abandonment_enabled?"🟢":"🔴","Price drop":n.price_drop.enabled,"Back in stock":n.back_in_stock.enabled,"optin type":{off:"off",oneStep:"Browser prompt",twoStep:"Custom prompt"}[n.optin.type],"Notification permission":Notification.permission,"Store section":U.section}),t.load3PIntegrations()})),this.ready=new Promise(function(e){t.init(a).then(function(){(t.environment!==w.ENVIRONMENT.production||!t.config.flags||!1!==t.config.flags.console_message&&"disabled"!==t.config.flags.console_message)&&t.customLog.log("[PushOwl Web Push Notifications] Starting up"),t.flyoutHandler=new u(t.config.flyout_config),t.browserHandler=new ht(t.config.vapid_public_key,t.config.flags&&"enabled"===t.config.flags.edgemesh?{edgemesh:{status:"enabled"}}:t.config.integrations,t.config.website_push_id),t.isAllowed()&&(t.render(),t.browserHandler.isPermissionGranted&&t.verifySubscriber().then(function(){t.config.abandoned_cart_enabled&&(t.syncAbandonedCart(),t.initAjaxCartDetection()),t.syncCustomerId(),t.syncProductView()}).catch(function(e,i){e===f.NO_SUBSCRIBER_TOKEN?t.subscribe().catch(function(t){n(t)}):e===f.INVALID_STATE_ERROR&&t.validateOrSyncSubscription(i)}),t.customTasks(),t.bisButtons(),t.pdButtons(),t.subscribeButtons(),t.checkPushowlSession(),t.exposeApi(),t.handleVariantChange(),e())}).catch(function(t){n(t)})}),this.debugHandler(),this.recoveredCartManager(),this.exposeApi()}return _createClass(r,[{key:"push",value:function(t){this.ready.then(function(){t()})}},{key:"exposeApi",value:function(){var e=this;this.LOG_LEVELS=_,this.setLogLevel=function(e){z.logLevel=e,t("Log level set to: ".concat(e))},this.isProductVariantSubscribed=function(t,n){return"price_drop"===t?e.storageManager.price_drop.isSubscribed({id:n}):"back_in_stock"===t?e.storageManager.back_in_stock.isSubscribed({id:n}):void 0},this.showBrowserPrompt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{overlay:{enabled:!1}};e.showNativePrompt(t)},this.showCustomPrompt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.config.optin.config,i=new L;i.setState({title:t.title||n.title,description:t.description||n.description,yesButton:t.yesButton||n.yesButton,noButton:t.noButton||n.noButton,theme:t.theme||n.theme,logo:t.logo||n.logo,position:t.position||n.position,yesButtonListener:function(){e.initiateDefaultPrompt(!1).then(function(){"function"==typeof t.yesButtonListener&&t.yesButtonListener()}),setTimeout(function(){i.destroy()},100)},noButtonListener:function(){setTimeout(function(){i.destroy()},100),e.sessionManager.isPermissionNotGranted=!0}})}}},{key:"load3PIntegrations",value:function(){var e=[];if("enabled"===this.config.flags.edgemesh||this.config.integrations&&this.config.integrations.edgemesh&&"enabled"===this.config.integrations.edgemesh.status){var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src="https://static.edgeme.sh/client.js",n.onload=function(){o.edgemesh=new Edgemesh({swUrl:"".concat(A.serviceWorkerUrl,"&integrations=edgemesh"),scope:"/",externalMount:!0,softDisable:!0})},document.head.appendChild(n),e.push("edgemesh"),t("[Intergration] Loading Edgemesh")}
e.length?o.Notification&&Notification.permission===w.NOTIFICATION_PERMISSION.GRANTED||navigator.serviceWorker.register("".concat(A.serviceWorkerUrl,"&integrations=").concat(e.join(",")),{scope:"/"}):o.Notification&&Notification.permission===w.NOTIFICATION_PERMISSION.GRANTED||navigator.serviceWorker.getRegistrations().then(function(t){t.forEach(function(t){t.active&&t.active.scriptURL.match(/pushowl/)&&t.unregister()})})}},{key:"handleVariantChange",value:function(){var e=this;if(U.section===N.SECTIONS.PRODUCT){var n=document.querySelector('form[action$="cart/add"]'),i=document.querySelector('select[name="id"]');if(!n&&i&&(n=i.closest("form")),!n)return;n.addEventListener("change",function(){setTimeout(function(){t("In-page variant change detected"),e.render()},500)})}}},{key:"isAllowed",value:function(){if(("bjg-dev"===this.subdomain||"leesa-sleep-3"===this.subdomain)&&(b.browser.isSafari||b.isMobile()))return!1;var t=this.config.activation_rule;return!t||t.processUrlActivationRule()}},{key:"isPostSubscribed",value:function(t,e){if(!t)return this.browserHandler.isPermissionGranted;if(e){var n=t.currentVariant();return this.browserHandler.isPermissionGranted&&e.isSubscribed(n)}return!1}},{key:"handlePushOwlButtons",value:function(t,e,n,i){var o=!0,s=!1,r=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done);o=!0){var u=a.value,l=u.dataset.pushowlPreDisplay,p=u.dataset.pushowlPreVisibility,d=u.dataset.pushowlPostDisplay,h=u.dataset.pushowlPostVisibility,f=u.dataset.pushowlPostSubscriptionMessage;this.isPostSubscribed(n,i)?(d&&(u.style.display=d),h&&(u.style.visibility=h),u.innerText=f):("none"===u.style.display&&(u.style.display=l||"block"),"hidden"===u.style.visibility&&(u.style.visibility=p||"visible")),u.addEventListener("click",e)}}catch(t){s=!0,r=t}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}}},{key:"subscribeButtons",value:function(){var t=this,e=document.querySelectorAll(".js-pushowl--subscribe");this.handlePushOwlButtons(e,function(e){t.subscribeIfNotAlready(!0).then(function(){var t=e.target.dataset.pushowlPostSubscriptionMessage;t&&(e.target.innerText=t)},null)},null,null)}},{key:"pdButtons",value:function(){var t=this,e=document.querySelectorAll(".js-pushowl--pd");e.length>0&&this.storeLib.getProductDetails().then(function(i){t.handlePushOwlButtons(e,function(e){t.subscribeIfNotAlready(!0).then(function(){var o=i.currentVariant();t.update(w.EVENT_API_PATH.PRICE_DROP,{product_id:i.id,product:i,variant:o,source:d.CUSTOM_BUTTONS,permission:Notification.permission}).then(function(){t.productSectionRender(i),t.storageManager.price_drop.subscribe(o);var n=e.target.dataset.pushowlPostSubscriptionMessage;n&&(e.target.innerText=n)}).catch(function(t){n(t)})})},i,t.storageManager.price_drop)})}},{key:"bisButtons",value:function(){var t=this,e=document.querySelectorAll(".js-pushowl--bis");e.length>0&&this.storeLib.getProductDetails().then(function(i){t.handlePushOwlButtons(e,function(e){t.subscribeIfNotAlready(!0).then(function(){var o=i.currentVariant();t.update(w.EVENT_API_PATH.BACK_IN_STOCK,{product_id:i.id,product:i,variant:o,source:d.CUSTOM_BUTTONS,permission:Notification.permission}).then(function(){t.productSectionRender(i),t.storageManager.back_in_stock.subscribe(o);var n=e.target.dataset.pushowlPostSubscriptionMessage;n&&(e.target.innerText=n)}).catch(function(t){n(t)})})},i,t.storageManager.back_in_stock)})}},{key:"init",value:function(e){var i=this;return new Promise(function(s,r){i.isEnabled().then(function(){(e||i.getConfig()).then(function(t){i.config=t,t.optin_report_enabled||(o.poAnalytics.track=function(){}),o.poAnalytics.setVisitorProperties({wid:i.config.wid,optinConfig:i.config.optin}),o.poAnalytics.meta.isNewVisitor&&o.poAnalytics.track("SessionCreated"),s(t)})}).catch(function(e){n(e),t("🔴 Shutting down. Reason: ".concat(e))})})}},{key:"initAjaxCartDetection",value:function(){var e=this;G.detectAjaxCartUpdate(function(){e.browserHandler.isPermissionGranted&&e.verifySubscriber().then(function(){t("[AJAX CART] Detected Add to Cart"),e.syncAbandonedCart()})}),this.config.flags&&this.config.flags.enable_cart_detection_2&&G.detectAjaxCartUpdate2(function(n){e.browserHandler.isPermissionGranted&&e.verifySubscriber().then(function(){t("[AJAX CART 2] Detected Add to Cart"),e.syncAbandonedCart(n)})}),this.config.flags&&this.config.flags.enable_cart_detection_3&&G.detectAjaxCartUpdate3(function(){e.browserHandler.isPermissionGranted&&e.verifySubscriber().then(function(){t("[AJAX CART 3] Detected Add to Cart"),e.syncAbandonedCart()})})}},{key:"render",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.config)throw"Pushowl Config not initialised";U.section===N.SECTIONS.HOME?this.defaultRender():U.section===N.SECTIONS.PRODUCT?this.storeLib.getProductDetails(n).then(function(t){e.productSectionRender(t)}):U.section===N.SECTIONS.CHECKOUT?t("🟠 Optin prompt was not shown. Reason: Checkout page"):this.defaultRender()}},{key:"initiateDefaultPrompt",value:function(t,e){var n=this;return this.subscribe(t,e).then(function(){n.render()}).catch(function(t){})}},{key:"showNativePrompt",value:function(e){function n(){o.poSubscriptionSource="browser-prompt",i.initiateDefaultPrompt(s,e)}var i=this,s=!b.isMobile()&&e.enabled;if(b.browser.isSafari||b.browser.isFirefox){var r=document.querySelector("body");t("This is Safari/Firefox browser. The prompt will only show after the website is clicked somewhere"),r.addEventListener("click",function(){n()})}else n()}},{key:"defaultRender",value:function(){var e=this;if(this.sessionManager.isPermissionNotGranted||Notification.permission!==w.NOTIFICATION_PERMISSION.DEFAULT){var i;this.sessionManager.isPermissionNotGranted?i="prompt was dismissed in this session":Notification.permission!==w.NOTIFICATION_PERMISSION.DEFAULT&&(i="permission already ".concat(Notification.permission)),t("🟠 Optin prompt was not shown. Reason: ".concat(i))}else if(this.config.optin){if(this.config.optin.type!==p.OFF){var s=this.config.optin.config,r=s.timeout,a=r.default,c=this.config.optin.type,u=s.overlay,l=u.enabled;b.isMobile()&&(l=!1,a=r.mobile);var d=this.sessionManager.optinSeenCount;if(m[1].isRunning(this.config)?(t("ab test: 1 (".concat(m[1].title,") running")),c=m[1].getValue()):m[6].isRunning(this.config)&&(t("ab test: 6 (".concat(m[6].title,") running")),c=m[6].getValue()),m[3].isRunning(this.config)&&(t("ab test: 3 (".concat(m[3].title,") running")),a=m[3].getValue(),c=p.ONE_STEP),m[4].isRunning(this.config)){t("ab test: 4 (".concat(m[4].title,") running"));var h=m[4].getValue(),f=h.optinType,g=h.optinConfig;c=f,s=_objectSpread({},s,{},g),a=b.isMobile()?s.timeout.mobile:s.timeout.default}if(m[7].isRunning(this.config)){t("ab test: 7 (".concat(m[7].title,") running"));var _=m[7].getValue(),S=_.optinType,v=_.optinConfig;c=S,a=v.timeout}-1===a?t('🟠 Optin prompt was not shown. Reason: timeout set to "never"'):d>=s.maxCountPerSession?t("🟠 Optin prompt was not shown. Reason: maximum count per session limit reached (".concat(d," / ").concat(s.maxCountPerSession,")")):Date.now()<z.optinDeferredUntil?t("🟠 Optin prompt was not shown. Reason: deferred till ".concat(new Date(z.optinDeferredUntil))):setTimeout(function(){if(Notification.permission!==w.NOTIFICATION_PERMISSION.DEFAULT)return void t("🟠 Optin prompt was not shown. Reason: permission not default");if(c===p.TWO_STEP){var n=e.config,i=s.position;m[2].isRunning(e.config)&&(t("ab test: 2 (".concat(m[2].title,") running")),i.default=m[2].getValue()),m[5].isRunning(e.config)&&(t("ab test: 5 (".concat(m[5].title,") running")),i.mobile=m[5].getValue());var r=new L;r.setState({title:s.title,description:s.description,yesButton:s.yesButton,noButton:s.noButton,theme:s.theme,logo:n.logo,branding:e.config.branding,position:i,yesButtonListener:function(){e.initiateDefaultPrompt(l,u),setTimeout(function(){r.destroy()},100),o.poSubscriptionSource="custom-prompt",o.poAnalytics.track("PNOptinAllowClicked",{optinSeenCount:e.sessionManager.optinSeenCount})},noButtonListener:function(){setTimeout(function(){r.destroy()},100),e.sessionManager.isPermissionNotGranted=!0,o.poAnalytics.track("PNOptinLaterClicked",{optinSeenCount:e.sessionManager.optinSeenCount})}}),e.sessionManager.optinSeenCount++,o.poAnalytics.track("PNOptinShown",{optinSeenCount:e.sessionManager.optinSeenCount}),t("Custom Prompt shown. Config: ",e.config.optin),s.deferForDays&&(z.optinDeferredUntil=Date.now()+86400*parseInt(s.deferForDays,10)*1e3)}else e.showNativePrompt(u)},1e3*a)}}else if(this.config.home.native_pop_up.enabled){var y=this.config.home.native_pop_up,C=b.isMobile()?y.timeout.mobile:y.timeout.default;-1===C?t("Skipping showing opt-in. Timeout received: ",C):setTimeout(function(){e.showNativePrompt(y.hint_screen)},1e3*C)}var T=this.config.home.flyout;if(T.enabled&&Notification.permission!==w.NOTIFICATION_PERMISSION.GRANTED){var E=T.title,O=T.buttonText;this.flyoutHandler.setState({title:E,buttonText:O,buttonListener:function(){e.subscribeIfNotAlready(!0).then(function(){e.flyoutHandler.setState({title:T.postSubscriptionTitle})}).catch(function(t){n(t)})}}),t("Flyout shown.","Config: ",this.config.home.flyout)}else t("Flyout was not shown. Reason: ".concat(T.enabled?"permission already granted":"flyout is is disabled"),"Config: ",this.config.home.flyout)}},{key:"productSectionRender",value:function(i){var s=this,r=i.currentVariant();e("Current product",{id:r.id,name:r.name,"Is in stock?":r.available?"✅":"❌",price:r.price});var a,c,u=function(){t(r)},l=this.config.back_in_stock,p=this.config.price_drop,h=this.config.flyout_config,f="";!r.available&&l.enabled?(f="back in stock",Notification.permission===w.NOTIFICATION_PERMISSION.GRANTED&&this.storageManager.back_in_stock.isSubscribed(r)?a=this._substitudePrice(l.postSubscriptionTitle,r.price):(a=l.title,c=l.buttonText,u=function(){s.flyoutHandler.setState({title:l.postSubscriptionTitle}),"default"===Notification.permission&&(o.poSubscriptionSource="back-in-stock-flyout"),s.subscribeIfNotAlready(h.overlay,h.overlay).then(function(){s.update(w.EVENT_API_PATH.BACK_IN_STOCK,{product_id:i.id,product:i,variant:r,source:d.FLYOUT_WIDGET,permission:Notification.permission}).then(function(){s.storageManager.back_in_stock.subscribe(r)}).catch(function(t){n(t)})})})):r.available&&p.enabled&&(f="price drop",Notification.permission===w.NOTIFICATION_PERMISSION.GRANTED&&this.storageManager.price_drop.isSubscribed(r)?a=p.postSubscriptionTitle:(a=this._substitudePrice(p.title,r.price),c=p.buttonText,u=function(){s.flyoutHandler.setState({title:p.postSubscriptionTitle}),"default"===Notification.permission&&(o.poSubscriptionSource="price-drop-flyout"),s.subscribeIfNotAlready(h.overlay,h.overlay).then(function(){s.update(w.EVENT_API_PATH.PRICE_DROP,{product_id:i.id,product:i,variant:r,subscribed_price:r.price,source:d.FLYOUT_WIDGET,permission:Notification.permission}).then(function(){s.storageManager.price_drop.subscribe(r)}).catch(function(t){n(t)})})})),(l.enabled||p.enabled)&&a?(this.flyoutHandler.setState({title:a,buttonText:c,buttonListener:u}),t("Product flyout shown for: ",f),t("🟠 Optin prompt was not shown. Reason: Product flyout shown")):this.defaultRender()}},{key:"getConfig",value:function(){var e=this;return new Promise(function(n,i){var o=e.sessionManager.config;if(o){t("Config fetched: from local cache.",o);try{n(new lt(o))}catch(t){n(o)}}else e.apiClient.config(e.tokenType,e.tokenValue).then(function(i){var o=new lt(i.result);e.sessionManager.config=o,n(o),t("Config fetched: from backend.",o)})})}},{key:"syncSubscriptionToServer",value:function(t,e){var i=this;return new Promise(function(o,s){i.apiClient.sendSubscription(t,e,i.config.website_push_id).then(function(e){z.handlePostSubscription(t,e),o()}).catch(function(t){n("Send Subscription Failed"),s(t)})})}},{key:"trackBrowserPromptAnalytics",value:function(t,e){o.poAnalytics.track("BrowserPromptShown",{delay:t,optinSeenCount:this.sessionManager.optinSeenCount});var n={allowed:"BrowserPromptAllowClicked",denied:"BrowserPromptDenyClicked",default:"BrowserPromptCloseClicked"};n[e]&&o.poAnalytics.track(n[e],{delay:t,optinSeenCount:this.sessionManager.optinSeenCount})}},{key:"subscribe",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=new s(n,{onDismiss:function(){e.sessionManager.isPermissionNotGranted=!0,o.poAnalytics.track("BrowserPromptOverlayDismissed",{optinSeenCount:e.sessionManager.optinSeenCount})}}),c=this.browserHandler.isPermissionGranted;return new Promise(function(n,o){a.show(i);var s=new Date;e.browserHandler.getSubscription().then(function(i){a.purge(),e.syncSubscriptionToServer(i,c).then(function(){return n()}).catch(function(){return o()}),c?t("🟢 Resync-subscription successfull. (bcoz permission was granted but didn't have a valid subscription)",i):(t("🟢 Subscription successfull",i),e.trackBrowserPromptAnalytics(new Date-s,"allowed"))}).catch(function(n){a.purge(),r&&a.show(),e.sessionManager.isPermissionNotGranted=!0,o(n),t("🔴 Subscription failed",n),c||e.trackBrowserPromptAnalytics(new Date-s,n)})})}},{key:"unsubscribe",value:function(){var t=this,e=alert;this.browserHandler.isPermissionGranted?this.apiClient.unsubscribe(z.subscriberToken).then(function(){e("You have been successfully unsubscribed from our push notifications.")}).catch(function(e){t.customLog.error(e)}):e("You have been successfully unsubscribed from our push notifications.")}},{key:"debug",value:function(){var t,e,n=w.STORAGE_KEYS,i={notification_permission:Notification.permission};i.localStorage=(t={},_defineProperty(t,n.VISITOR_TOKEN,z.visitorToken),_defineProperty(t,n.SESSION_TOKEN,z.sessionToken),_defineProperty(t,n.SUBSCRIBER_TOKEN,z.subscriberToken),_defineProperty(t,n.SUBSCRIPTION,z.subscription),_defineProperty(t,n.BACK_IN_STOCK_SUBSCRIPTIONS,this.storageManager.back_in_stock.subscriptions),_defineProperty(t,n.PRICE_DROP_SUBSCRIPTIONS,this.storageManager.price_drop.subscriptions),_defineProperty(t,n.SYNCED_CART_JSON,z.synced_cart_json),_defineProperty(t,n.SYNCED_CUSTOMER_ID,z.syncedCustomerId),_defineProperty(t,n.SYNCED_AC_EVENTS,z.ac_events),_defineProperty(t,n.OPTIN_DEFERRED_UNTIL,z.optinDeferredUntil),t),i.sessionStorage=(e={},_defineProperty(e,this.sessionManager.subscriptionVerifiedKey,this.sessionManager.subscriptionVerified),_defineProperty(e,this.sessionManager.permissionKey,this.sessionManager.isPermissionNotGranted),_defineProperty(e,this.sessionManager.optinSeenCountKey,this.sessionManager.optinSeenCount),e),i.subdomain=this.subdomain,i.debug_url=o.location.href,i.user_agent=navigator.userAgent;var s=null;this.isEnabled().catch(function(t){s=t}).finally(function(){i.pushowl_not_enabled_reason=s,U.getCart().then(function(t){i.current_cart_json=t}).finally(function(){o.prompt("Send this to PushOwl Support",JSON.stringify(i))})}),this.apiClient.debugLog(i)}},{key:"subscribeIfNotAlready",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise(function(i,o){t.browserHandler.isPermissionGranted?z.subscriberToken?i(!0):t.subscribe(!1,null,!1).then(function(){return i(!0)}).catch(function(t){return o(t)}):t.subscribe(e,null,n).then(function(){return i(!0)}).catch(function(t){return o(t)})})}},{key:"validateOrSyncSubscription",value:function(e){var n=this;return new Promise(function(i,o){var s=z.subscription;if(!s)return t("Syncing new subscription to server"),n.syncSubscriptionToServer(e);e.endpoint===s.endpoint?i():(t("Syncing new subscription to server"),n.apiClient.refreshSubscription(z.subscriberToken,s,e).then(function(t){z.handlePostSubscription(e,t),i()}).catch(function(t){o(t)}))})}},{key:"verifySubscriber",value:function(){var e=this;return t("Verifying subscriber..."),new Promise(function(n,i){z.subscriberToken?e.sessionManager.subscriptionVerified?n():b.browser.isSafari?e.browserHandler.isPermissionGranted?n():i():b.browser.isSafari||e.browserHandler.getSubscription().then(function(o){e.validateOrSyncSubscription(o).then(function(){n(),t("🟢 Subscriber verified.")}).catch(function(){i(),t("🔴 Subscriber could not be verified.")})}).catch(function(e,n){i(e,n),t("🔴 Subscription could not be fetched.",e,n)}):(i(f.NO_SUBSCRIBER_TOKEN),t("🔴 Subscriber could not be verified. Reason: ",f.NO_SUBSCRIBER_TOKEN))})}},{key:"update",value:function(e,n){return n.subscriber_token=z.subscriberToken,t("Event Subscription",n),this.apiClient.sendEvent(e,n)}},{key:"isEnabled",value:function(){var t=this;return new Promise(function(e,n){"undefined"==typeof __st&&void 0===o.Shopify&&n(h.NOT_SHOPIFY),"undefined"==typeof Notification&&n(h.NOTIFICATION_NOT_DEFINED),"undefined"==typeof Storage&&n(h.STORAGE_NOT_DEFINED),!0!==i()&&n(h.LOCALSTORAGE_NOT_AVAILABLE),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!o.MSStream&&n(h.IOS_DEVICE),/Edge/.test(navigator.userAgent)&&n(h.MICROSOFT_EDGE),b.browser.isIOS||b.browser.isSafari||"serviceWorker"in navigator||n(h.NO_SERVICE_WORKER),t.subdomain||n(h.NO_SUBDOMAIN);var s=o.RequestFileSystem||o.webkitRequestFileSystem;s?s(o.TEMPORARY,100,e,function(){n(h.INCOGNITO)}):e(h.NO_FILE_SYSTEM)})}},{key:"_substitudePrice",value:function(t,e){e=e.toFixed(2);var n=this.config.shop.money_format.replace("{{amount}}",e);return t.replace("{{product_price}}",n).replace("{{variant_price}}",n)}},{key:"debugHandler",value:function(){b.getParameterByName("poTaskType")===k.DEBUG&&this.debug()}},{key:"httpPost",value:function(t,e){return b.request({method:"POST",url:t,payload:e})}},{key:"recoveredCartManager",value:function(){var e=this,i=b.getParameterByName("poCartData");if(i)try{var s=JSON.parse(o.atob(i));U.getCart().then(function(n){if(0===new V(n).item_count){var i=s.cart;e.httpPost("/cart/update.js",{updates:i}).then(function(){t("Cart Update Done"),o.location.href=o.location.origin+o.location.pathname})}})}catch(t){n(t)}}},{key:"customTasks",value:function(){var t=b.getParameterByName("poTaskType");t===k.SUBSCRIBE?this.subscribeIfNotAlready(!0):t===k.UNSUBSCRIBE&&this.unsubscribe()}},{key:"initNotificationPreference",value:function(){t("Notification Preference",this.subdomain);var e=document.querySelector("body"),n={subdomain:this.subdomain,subscriberToken:z.subscriberToken},i=this.config.privacy;if(i.notification_preference.enabled){var o=new c(e,n,i.notification_preference);new a(e,i.notification_preference,o).render()}}},{key:"checkPushowlSession",value:function(){"pushowl"===b.getParameterByName("utm_source")&&this.initNotificationPreference()}},{key:"syncAbandonedCart",value:function(e){var i=this;(e?Promise.resolve(e):U.getCart()).then(function(e){var o=new V(e),s=["Cart Token:",o.token,"Cart Items",o.item_count,"Last synced Cart:",z.synced_cart_json,"AC Events:",z.ac_events],r=z.synced_cart_json,a=r?new V(r):null;o.item_count>0&&(!a||o.cartId!==a.cartId)||0===o.item_count&&a&&a.token===o.token&&a.cartId!==o.cartId?i.apiClient.syncCart(e).then(function(n){z.synced_cart_json=e,z.ac_events=n.result,t("Cart synced successfully. Response: ",n)}).catch(function(e){n(e),t.apply(void 0,["🔴 Cart sync failed. Error: request failed. ",e].concat(s))}):t.apply(void 0,["Cart was not synced. Reason: No change since last sync."].concat(s))}).catch(function(e){n(e),t.apply(void 0,["🔴 Cart sync failed. Error: cart could not be fetched.  ",e].concat(_toConsumableArray(debugArgs)))})}},{key:"syncProductView",value:function(){var e=this;U.section===N.SECTIONS.PRODUCT&&this.config.browse_abandonment_enabled&&this.storeLib.getRawCurrentProductDetails().then(function(i){e.apiClient.syncProductView(i).then(function(e){t("Product synced",e)}).catch(function(t){n(t)})}).catch(function(t){n(t)})}},{key:"syncCustomerId",value:function(){U.customerId&&U.customerId!==z.syncedCustomerId&&this.config.privacy.customer_id&&this.apiClient.syncSubscriber().then(function(){z.syncedCustomerId=U.customerId}).catch(function(){n("Subscriber not synced")})}},{key:"subscriberLog",value:function(t){var e=Object.entries(t).map(function(t){var e=_slicedToArray(t,2),n=e[0],i=e[1];return"".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(i))}).join("&"),n="".concat(this.apiEndpoint,"/api/v1/").concat(this.subdomain,"/log/?").concat(e);return b.request({url:n}).then(function(t){return t},function(){return"Logging failed"})}},{key:"registerForEvent",value:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(s,r){e.subscribeIfNotAlready(i).then(function(){e.storeLib.getProductDetails(!1,o.productAlias).then(function(i){var a=o.productVariantId?i.getVariant(o.productVariantId):i.currentVariant(),c=null,u=null;if(t===g.BACK_IN_STOCK)c=w.EVENT_API_PATH.BACK_IN_STOCK,u=e.storageManager.back_in_stock;else{if(t!==g.PRICE_DROP)return void r(f.UNKNOWN_EVENT);c=w.EVENT_API_PATH.PRICE_DROP,u=e.storageManager.price_drop}e.update(c,{product_id:i.id,product:i,variant:a,source:d.PARTNER_JS_API,permission:Notification.permission}).then(function(){e.productSectionRender(i),u.subscribe(a);var t={};t[w.STORAGE_KEYS.SUBSCRIBER_TOKEN]=z.subscriberToken,s(t)}).catch(function(t){n(t)})})}).catch(function(){r({error_code:f.PERMISSION_NOT_GRANTED})})})}}]),r}(),a=function(){function t(e,n,i){_classCallCheck(this,t),this.container=e,this.npWidget=i,this.notificationPreference=n}return _createClass(t,[{key:"render",value:function(){var t=this;this.node=this.createNode(),this.container.appendChild(this.node),this.close=this.node.querySelector(".js-po-np-toggle--close"),this.node.addEventListener("click",function(){t.npWidget.render()}),this.close.addEventListener("click",function(e){t.node.parentNode.removeChild(t.node),e.preventDefault(),e.stopPropagation()})}},{key:"createNode",value:function(){var t,e=this.notificationPreference;return t='<div class="js-po-np-toggle" style="cursor:pointer;z-index:2147483646;transform: translateZ(1);position:fixed;bottom:0;right:10px;border-radius: 4px 4px 0 0;background-color: rgba(0,0,0,0.7);box-shadow: 0 2px 4px 0 rgba(0,0,0,0.5);color: #FFFFFF;font-size:12px;padding: 8px 10px 8px 20px;display:inline-block"><span style="position: relative;top:-2px">'.concat(e.message,'</span>\n&nbsp;&nbsp;&nbsp;&nbsp;<span class="js-po-np-toggle--close" style="cursor: pointer;" >X</span>\n</div>'),b.parseHTML(t)}}]),t}(),c=function(){function e(t,n,i){_classCallCheck(this,e),this.container=t,this.data=n,this.notificationPreference=i}return _createClass(e,[{key:"render",value:function(){var e=this;this.node=this.createNode(),this.container.appendChild(this.node),this.npContainer=this.node.querySelector(".js-po-np--container"),t(this.accessMyDataForm),this.access=this.node.querySelector(".js-po-np--access"),this.delete=this.node.querySelector(".js-po-np--delete"),this.unsubscribe=this.node.querySelector(".js-po-np--unsubscribe"),this.close=this.node.querySelector(".js-po-np--close"),this.access&&this.access.addEventListener("click",function(){o.open(e.accessMyDataForm)}),this.delete&&this.delete.addEventListener("click",function(){o.open(e.deleteMyDataForm)}),this.unsubscribe&&this.unsubscribe.addEventListener("click",function(){o.open(e.unsubscribeForm)}),this.close.addEventListener("click",function(){e.node.parentNode.removeChild(e.node)}),this.node.addEventListener("click",function(){e.node.parentNode.removeChild(e.node)}),this.npContainer.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation()})}},{key:"createNode",value:function(){var t,e=this.notificationPreference,n=this.notificationPreference.actions;return t='<div class="js-po-np--overlay"\n     style="position: fixed;top: 0;bottom: 0;left: 0;right: 0;background: rgba(0,0,0,0.65);z-index: 9999999;">\n    <div class="js-po-np--container"\n         style="background: #fff;box-shadow: 0 2px 15px 0 rgba(0, 0, 0, 0.16);border-radius: 1.92px;padding: 25px 50px;position: absolute;top: 50%;transform: translateY(-70%) translateX(-50%);left: 50%;">\n        <div class="js-po-np--text"\n             style="font-size: 16px;line-height: 18px;padding-bottom: 10px;border-bottom: 0.64px solid #979797;margin-bottom: 20px;text-align: center;">\n             '.concat(e.message,'\n        </div>\n        <div class="js-po-np--buttons" style="text-align: center">'),n.access_data.enabled&&(t+='<div style="margin-top: 10px;min-height: 22px">\n                    <a class="js-po-np--access"\n                    style="cursor: pointer; white-space: nowrap;height: 22px;min-width: 100px;line-height: 14px;padding: 5px 10px;font-size: 14px;font-weight: 400;border-radius: 2px;color: #fff;background-color: #188675;">'.concat(n.access_data.text,"</a>\n                    </div>")),n.delete_data.enabled&&(t+='<div style="margin-top: 10px;min-height: 22px">\n                    <a class="js-po-np--delete"\n                    style="cursor: pointer; white-space: nowrap;height: 22px;min-width: 100px;line-height: 14px;padding: 5px 10px;font-size: 14px;font-weight: 400;border-radius: 2px;color: #fff;background-color: #9F9F9F;">'.concat(n.delete_data.text,"</a>\n                    </div>")),n.unsubscribe.enabled&&(t+='<div style="margin-top: 15px;min-height: 22px">\n                    <a class="js-po-np--unsubscribe"\n                    style="cursor: pointer; white-space: nowrap;height: 22px;min-width: 100px;line-height: 14px;padding: 5px 10px;font-size: 14px;font-weight: 400;border-radius: 2px;color: #fff;background-color: #9F9F9F;">'.concat(n.unsubscribe.text,"</a>\n                        </div>")),t+='</div>\n                            <span class="js-po-np--close" style="position: absolute;top: 5px;right: 10px;font-weight: bold;font-size: 12px;cursor: pointer;">X</span>\n                        </div>\n                    </div>',b.parseHTML(t)}},{key:"accessMyDataForm",get:function(){var t=this.data,e=o.location.origin;return"https://access-push-data.paperform.co/?blpf8=".concat(t.subscriberToken,"&17vii=").concat(e,"&afg4h=").concat(t.subdomain)}},{key:"deleteMyDataForm",get:function(){var t=this.data,e=o.location.origin;return"https://delete-push-data.paperform.co/?7uv2c=".concat(t.subscriberToken,"&9e21s=").concat(e,"&2te0r=").concat(t.subdomain)}},{key:"unsubscribeForm",get:function(){return"http://docs.pushowl.com/subscribers/unsubscribing-from-push"}}]),e}(),u=function(){function t(e){_classCallCheck(this,t);var n=b.isMobile()?R:P;this.widget=new n(e)}return _createClass(t,[{key:"setState",value:function(t){this.widget.setState(t)}}]),t}();o.poAnalytics=new y({endpoint:"".concat(A.apiEndpoint,"/event/v1/events")});var l={storeConfigGUID:A.guid,subdomain:A.subdomain,visitorToken:z.visitorToken,sessionToken:z.sessionToken};o.poAnalytics.setVisitorProperties(l),t("Analytics initialized with data: ",l),o.poSubscriptionSource="";var S=[];o.pushowl&&o.pushowl instanceof Array&&(S=o.pushowl,t("Existing PushOwl found in queue mode with following tasks queued: ",S)),!o.pushowl||o.pushowl instanceof Array||t("Existing PushOwl found and will be reused. Pushowl seems to be loading twice on this page. Please check page source."),(!o.pushowl||o.pushowl instanceof Array)&&(o.pushowl=new r,t("PushOwl instance created")),o.pushowl.ready.then(function(){t("PushOwl ready to execute API functions."),S.length&&(S.forEach(function(t){t()}),t("Tasks from PushOwl queue executed. No. of tasks: ".concat(S.length)))})}(window)}();